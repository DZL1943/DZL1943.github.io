"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[61419],{28453(e,n,i){i.d(n,{R:()=>l,x:()=>a});var s=i(96540);const t={},r=s.createContext(t);function l(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:n},e.children)}},62747(e,n,i){i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>c,frontMatter:()=>l,metadata:()=>s,toc:()=>p});const s=JSON.parse('{"id":"Computer/Application/Obsidian/Obsidian Web Clipper","title":"Obsidian Web Clipper","description":"\u754c\u9762","source":"@site/vault/Areas/Computer/90_Application/Obsidian/Obsidian Web Clipper.md","sourceDirName":"Computer/90_Application/Obsidian","slug":"/Computer/Application/Obsidian/Obsidian Web Clipper","permalink":"/docs/Computer/Application/Obsidian/Obsidian Web Clipper","draft":false,"unlisted":true,"tags":[],"version":"current","lastUpdatedAt":1769837821000,"frontMatter":{"modified":"2025-12-02T22:05","unlisted":true,"url":["https://obsidian.md/clipper","https://help.obsidian.md/web-clipper"],"aliases":["Obsidian \u526a\u85cf"],"date":"2025-12-02T22:03"},"sidebar":"obsidianSidebar"}');var t=i(74848),r=i(28453);const l={modified:"2025-12-02T22:05",unlisted:!0,url:["https://obsidian.md/clipper","https://help.obsidian.md/web-clipper"],aliases:["Obsidian \u526a\u85cf"],date:"2025-12-02T22:03"},a=void 0,o={},p=[{value:"\u754c\u9762",id:"\u754c\u9762",level:2},{value:"\u8bbe\u7f6e",id:"\u8bbe\u7f6e",level:2},{value:"\u6a21\u677f",id:"\u6a21\u677f",level:2},{value:"\u53d8\u91cf",id:"\u53d8\u91cf",level:2},{value:"\u8fc7\u6ee4\u5668",id:"\u8fc7\u6ee4\u5668",level:2},{value:"Examples",id:"examples",level:2},{value:"\u811a\u672c",id:"\u811a\u672c",level:2}];function d(e){const n={code:"code",h2:"h2",li:"li",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"\u754c\u9762",children:"\u754c\u9762"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Header","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u6a21\u677f"}),"\n",(0,t.jsx)(n.li,{children:"\u663e\u793a\u9875\u9762\u53d8\u91cf"}),"\n",(0,t.jsx)(n.li,{children:"\u9ad8\u4eae"}),"\n",(0,t.jsx)(n.li,{children:"\u5728\u9875\u9762\u4e2d\u6253\u5f00"}),"\n",(0,t.jsx)(n.li,{children:"\u8bbe\u7f6e"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"Properties"}),"\n",(0,t.jsx)(n.li,{children:"Note content"}),"\n",(0,t.jsxs)(n.li,{children:["Footer","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u6dfb\u52a0"}),"\n",(0,t.jsx)(n.li,{children:"\u6587\u4ef6\u5939"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"\u8bbe\u7f6e",children:"\u8bbe\u7f6e"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u5e38\u89c4"}),"\n",(0,t.jsx)(n.li,{children:"\u5c5e\u6027"}),"\n",(0,t.jsx)(n.li,{children:"\u9ad8\u4eae"}),"\n",(0,t.jsx)(n.li,{children:"\u89e3\u91ca\u5668"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"\u6a21\u677f",children:"\u6a21\u677f"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u540d\u79f0"}),"\n",(0,t.jsx)(n.li,{children:"\u884c\u4e3a"}),"\n",(0,t.jsx)(n.li,{children:"\u6587\u4ef6\u540d"}),"\n",(0,t.jsx)(n.li,{children:"\u6587\u4ef6\u5939"}),"\n",(0,t.jsx)(n.li,{children:"\u5e93"}),"\n",(0,t.jsx)(n.li,{children:"\u89e6\u53d1\u5668"}),"\n",(0,t.jsx)(n.li,{children:"\u5c5e\u6027"}),"\n",(0,t.jsx)(n.li,{children:"\u5185\u5bb9"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"\u53d8\u91cf",children:"\u53d8\u91cf"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Preset variables"}),"\n",(0,t.jsx)(n.li,{children:"Prompt variables"}),"\n",(0,t.jsx)(n.li,{children:"Meta variables"}),"\n",(0,t.jsx)(n.li,{children:"Selector variables"}),"\n",(0,t.jsx)(n.li,{children:"Schema.org variables"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"\u8fc7\u6ee4\u5668",children:"\u8fc7\u6ee4\u5668"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Dates"}),"\n",(0,t.jsx)(n.li,{children:"Text conversion and capitalization"}),"\n",(0,t.jsx)(n.li,{children:"Text formatting"}),"\n",(0,t.jsx)(n.li,{children:"Numbers"}),"\n",(0,t.jsx)(n.li,{children:"HTML processing"}),"\n",(0,t.jsx)(n.li,{children:"Arrays and objects"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:"fold",children:'{\n  "schemaVersion": "0.1.0",\n  "name": "91",\n  "behavior": "create",\n  "noteContentFormat": "\\n{{selector:video?poster|image}}\\n",\n  "properties": [\n    {\n      "name": "title",\n      "value": "{{title}}",\n      "type": "text"\n    },\n    {\n      "name": "url",\n      "value": "{{url}}",\n      "type": "text"\n    },\n    {\n      "name": "image",\n      "value": "{{image}}",\n      "type": "text"\n    },\n    {\n      "name": "tags",\n      "value": "clippings/91, av",\n      "type": "multitext"\n    },\n    {\n      "name": "created",\n      "value": "{{time}} ",\n      "type": "date"\n    }\n  ],\n  "triggers": [\n    "/^https:\\\\/\\\\/(.*)\\\\/video(s)?\\\\/view(hd)?\\\\/(.*)/"\n  ],\n  "noteNameFormat": "{{title|safe_name}}",\n  "path": "Inbox"\n}\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",metastring:"fold",children:'{\n  "schemaVersion": "0.1.0",\n  "name": "51",\n  "behavior": "create",\n  "noteContentFormat": "\\n{{selector:div.post-content img:is([src^=\\"data:image/jpeg;base64,\\"], [src^=\\"data:image/jpg;base64,\\"])?src|slice:0,-1|image|join:\\"\\\\n\\\\n\\"}}\\n",\n  "properties": [\n    {\n      "name": "title",\n      "value": "{{title}}",\n      "type": "text"\n    },\n    {\n      "name": "url",\n      "value": "{{url}}",\n      "type": "text"\n    },\n    {\n      "name": "image",\n      "value": "",\n      "type": "text"\n    },\n    {\n      "name": "tags",\n      "value": "clippings/51, av",\n      "type": "multitext"\n    },\n    {\n      "name": "created",\n      "value": "{{time}} ",\n      "type": "date"\n    }\n  ],\n  "triggers": [\n    "/https:\\\\/\\\\/(.*)\\\\/archives\\\\/(\\\\d+)/"\n  ],\n  "noteNameFormat": "{{title|safe_name}}",\n  "path": "Inbox"\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"\u811a\u672c",children:"\u811a\u672c"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",metastring:"fold",children:'import httpx\nimport re\nimport os\nfrom urllib.parse import urlparse, urljoin\nfrom datetime import datetime\nfrom bs4 import BeautifulSoup\n\n\nclass BaseParser:\n    DOMAIN = None\n    REDIRECT_RULES = []\n    IMAGE_INDEX = -1\n    IMAGE_SELECTOR = \'img\'\n    IMAGE_ATTR = \'src\'\n    IMAGE_EXTS = {\'webp\', \'jpg\', \'jpeg\'}\n    \n    def __init__(self, url):\n        self.url = url\n        self.domain = self.DOMAIN or urlparse(self.url).netloc.replace("www.", "").split(".")[0]\n        self.tags = [f"clippings/{self.domain}"]\n        self.title = \'\'\n        self.image = \'\'\n        self.images = []\n        self.content = \'\'\n        self.created = \'\'\n        self.soup = None\n    \n    @classmethod\n    def match_and_redirect(cls, url):\n        for pattern, redirect in cls.REDIRECT_RULES:\n            if re.search(pattern, url):\n                if redirect:\n                    try:\n                        url = re.sub(pattern, redirect, url)\n                    except Exception:\n                        pass\n                return url\n\n    def parse(self):\n        headers = {\n            \'User-Agent\': \'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36\',\n        }\n        resp = httpx.get(self.url, headers=headers, timeout=30.0, follow_redirects=True, verify=False)\n        resp.raise_for_status()\n        self.soup = BeautifulSoup(resp.content, "html.parser")\n        \n        self._parse_meta()\n        self._parse_content()\n        self._set_image()\n        self.created = datetime.now().isoformat(timespec=\'seconds\')\n    \n    def _parse_meta(self):\n        if meta_title := self.soup.find("meta", property="og:title"):\n            self.title = meta_title.get(\'content\')\n        else:\n            self.title = self.soup.title.string\n        \n        if meta_image := self.soup.find("meta", property="og:image"):\n            self.image = meta_image.get(\'content\')\n    \n    def _parse_content(self):\n        self.images = self._parse_images()\n        self.content = "\\n\\n".join(f"![]({img})" for img in self.images)\n    \n    def _normalize(self, url):\n        if url.startswith("//"):\n            return "https:" + url\n        elif url.startswith(("http://", "https://", "data:")):\n            return url\n        return urljoin(self.url, url)\n\n    def _parse_images(self):\n        images = []\n        seen = set()\n        \n        for img in self.soup.select(self.IMAGE_SELECTOR):\n            if src := img.get(self.IMAGE_ATTR):\n                img_url = self._normalize(src)\n                if not self._filter_image(img_url):\n                    continue\n                if img_url not in seen:\n                    seen.add(img_url)\n                    images.append(img_url)\n        return images\n    \n    def _filter_image(self, img_url):\n        if not self.IMAGE_EXTS:\n            return True\n\n        if img_url.startswith("data:image/"):\n            ext = img_url.split(\';\')[0].split(\'/\')[1]\n        else:\n            clean = img_url.split(\'?\')[0].split(\'#\')[0]\n            ext = clean.split(\'.\')[-1].lower() if \'.\' in clean else \'\'\n        \n        return ext in self.IMAGE_EXTS\n    \n    def _set_image(self):\n        if not self.image and self.images:\n            self.image = self._get_by_index(self.images, self.IMAGE_INDEX)\n    \n    @staticmethod\n    def _get_by_index(arr, pos):\n        if not arr:\n            return None\n        if pos < 0:\n            pos = len(arr) + pos\n        pos = max(0, min(pos, len(arr) - 1))\n        return arr[pos]\n    \n    def generate_markdown(self):\n        frontmatter = f"""---\ntitle: {self.title}\nurl: {self.url}\nimage: {self.image}\ntags: {self.tags}\ncreated: {self.created}\n---"""\n        return f"{frontmatter}\\n\\n{self.content}"\n\n\nclass PornyClipper(BaseParser):\n    DOMAIN = \'91\'\n    REDIRECT_RULES = [\n        (r\'https://(.*)/view_video\\.php\\?viewkey=([a-z0-9]+).*\', r\'https://tog.jiuse9002.com/video/view/\\2\'),\n        (r"https://(.*)/video(s)?/view(hd)?/(.*)", r"https://tog.jiuse9002.com/video\\2/view/\\4")\n    ]\n    IMAGE_SELECTOR = \'video\'\n    IMAGE_ATTR = \'poster\'\n\n\nclass ChiguaClipper(BaseParser):\n    DOMAIN = \'51\'\n    REDIRECT_RULES = [\n        (r"https://(.*)/archives/(.*)", r"https://basket.gekjezba.cc/archives/\\2")\n    ]\n    IMAGE_SELECTOR = \'div.post-content img\'\n    IMAGE_ATTR = \'data-xkrkllgl\'\n    \n    def _set_image(self):\n        self.image = \'\'\n\n\nclass WebToMarkdown:\n    PARSERS = [PornyClipper, ChiguaClipper]\n    \n    def __init__(self, output_dir="./output"):\n        self.output_dir = output_dir\n        os.makedirs(output_dir, exist_ok=True)\n    \n    def get_parser(self, url):\n        for parser_class in self.PARSERS:\n            if new_url := parser_class.match_and_redirect(url):\n                print(f"{parser_class}  {new_url}")\n                return parser_class(new_url)\n        return BaseParser(url)\n    \n    def process_url(self, url):\n        try:\n            parser = self.get_parser(url)\n            parser.parse()\n            self._save(\n                os.path.join(\n                    self.output_dir,\n                    parser.domain,\n                    (\n                        re.sub(r"[^\\w\\-]", "_", parser.title)[:50]\n                        if parser.title\n                        else datetime.now().strftime("%Y%m%d%H%M%S")\n                    )\n                    + ".md",\n                ),\n                parser.generate_markdown(),\n            )\n        except Exception as e:\n            print(f"\u5904\u7406\u5931\u8d25 {url}: {e}")\n    \n    def process_urls(self, urls):\n        for url in urls:\n            self.process_url(url)\n    \n    def _save(self, filepath, data):\n        os.makedirs(os.path.dirname(filepath), exist_ok=True)\n        \n        if os.path.exists(filepath):\n            print(f"\u8986\u76d6: {filepath}")\n        \n        with open(filepath, "w", encoding="utf-8") as f:\n            f.write(data)\n\n        print(f"\u4fdd\u5b58: {filepath}")\n\n\nif __name__ == "__main__":\n    converter = WebToMarkdown()\n    converter.process_urls([\n        "https://uiq.91pn104.cc/video/view/e07fb0de0d968fbb0724",\n        "https://affect.ffqrvjzr.com/archives/158228/",\n    ])\n'})})]})}function c(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);