"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[2403],{11867(e,n,a){a.r(n),a.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"Computer/Application/Obsidian/obsidian-dataview","title":"Dataview","description":"Metadata","source":"@site/vault/docs/Computer/90_Application/Obsidian/obsidian-dataview.md","sourceDirName":"Computer/90_Application/Obsidian","slug":"/Computer/Application/Obsidian/obsidian-dataview","permalink":"/docs/Computer/Application/Obsidian/obsidian-dataview","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Obsidian/Plugins","permalink":"/docs/tags/obsidian-plugins"}],"version":"current","lastUpdatedAt":1768224161000,"frontMatter":{"title":"Dataview","modified":"2025-10-08T21:27","tags":["Obsidian/Plugins"],"aliases":["Dataview","dataview"],"obsidianEditingMode":"source","obsidianUIMode":"preview","url":["https://blacksmithgu.github.io/obsidian-dataview/"],"date":"2024-07-25T10:35"},"sidebar":"obsidianSidebar","previous":{"title":"Datacore","permalink":"/docs/Computer/Application/Obsidian/obsidian-datacore"},"next":{"title":"Excalidraw","permalink":"/docs/Computer/Application/Obsidian/obsidian-excalidraw"}}');var t=a(74848),l=a(28453);const s={title:"Dataview",modified:"2025-10-08T21:27",tags:["Obsidian/Plugins"],aliases:["Dataview","dataview"],obsidianEditingMode:"source",obsidianUIMode:"preview",url:["https://blacksmithgu.github.io/obsidian-dataview/"],date:"2024-07-25T10:35"},r="Dataview",d={},o=[{value:"Metadata",id:"metadata",level:2},{value:"Data Types",id:"data-types",level:3},{value:"DQL &amp; Inline DQL",id:"dql--inline-dql",level:2},{value:"Query Types",id:"query-types",level:3},{value:"LIST",id:"list",level:4},{value:"TABLE",id:"table",level:4},{value:"TASK",id:"task",level:4},{value:"CALENDAR",id:"calendar",level:4},{value:"Query Sources",id:"query-sources",level:3},{value:"Data Commands",id:"data-commands",level:3},{value:"Expressions",id:"expressions",level:3},{value:"Literals",id:"literals",level:3},{value:"Functions",id:"functions",level:3},{value:"DataviewJS &amp; Inline DataviewJS",id:"dataviewjs--inline-dataviewjs",level:2},{value:"Examples",id:"examples",level:2},{value:"\u6b63\u53cd\u94fe",id:"\u6b63\u53cd\u94fe",level:3},{value:"\u4efb\u52a1",id:"\u4efb\u52a1",level:3},{value:"\u65e5\u5386",id:"\u65e5\u5386",level:3},{value:"\u5217\u4e3e\u4e66\u7b7e\u6587\u4ef6",id:"\u5217\u4e3e\u4e66\u7b7e\u6587\u4ef6",level:3},{value:"\u5217\u4e3e\u6807\u7b7e",id:"\u5217\u4e3e\u6807\u7b7e",level:3},{value:"\u4ec5\u5217\u4e3e\u6839\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6",id:"\u4ec5\u5217\u4e3e\u6839\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6",level:3},{value:"\u5217\u4e3e\u7279\u5b9a\u6df1\u5ea6\u7684\u76ee\u5f55\u7ed3\u6784",id:"\u5217\u4e3e\u7279\u5b9a\u6df1\u5ea6\u7684\u76ee\u5f55\u7ed3\u6784",level:3},{value:"\u6700\u8fd1\u4fee\u6539\u7684\u6587\u4ef6",id:"\u6700\u8fd1\u4fee\u6539\u7684\u6587\u4ef6",level:3},{value:"\u6240\u6709\u6587\u4ef6\u6309\u6587\u4ef6\u5939\u5206\u7ec4",id:"\u6240\u6709\u6587\u4ef6\u6309\u6587\u4ef6\u5939\u5206\u7ec4",level:3},{value:"\u6240\u6709\u6587\u4ef6\u6309\u5f53\u524d\u6587\u4ef6\u5939\u4e0b\u7684\u5b50\u6587\u4ef6\u5939\u5206\u7ec4",id:"\u6240\u6709\u6587\u4ef6\u6309\u5f53\u524d\u6587\u4ef6\u5939\u4e0b\u7684\u5b50\u6587\u4ef6\u5939\u5206\u7ec4",level:3},{value:"\u5217\u4e3e\u5f53\u524d\u76ee\u5f55\u4e0b\u7279\u5b9a\u6587\u4ef6\u540d\u7684\u6587\u4ef6, \u5e76\u7528 callout \u663e\u793a\u5176\u5185\u5bb9",id:"\u5217\u4e3e\u5f53\u524d\u76ee\u5f55\u4e0b\u7279\u5b9a\u6587\u4ef6\u540d\u7684\u6587\u4ef6-\u5e76\u7528-callout-\u663e\u793a\u5176\u5185\u5bb9",level:3},{value:"\u5728\u5355\u6587\u4ef6\u65e5\u8bb0\u4e2d\u4f7f\u7528 flatten",id:"\u5728\u5355\u6587\u4ef6\u65e5\u8bb0\u4e2d\u4f7f\u7528-flatten",level:3},{value:"dvjs \u624b\u52a8\u6784\u9020\u6570\u636e",id:"dvjs-\u624b\u52a8\u6784\u9020\u6570\u636e",level:3},{value:"\u624b\u52a8\u6269\u5c55 pages",id:"\u624b\u52a8\u6269\u5c55-pages",level:3},{value:"\u5355\u6587\u4ef6\u67e5\u8be2\u65f6\u6309\u67d0\u5b57\u6bb5\u5c55\u5e73",id:"\u5355\u6587\u4ef6\u67e5\u8be2\u65f6\u6309\u67d0\u5b57\u6bb5\u5c55\u5e73",level:3},{value:"\u6784\u9020\u94fe\u63a5",id:"\u6784\u9020\u94fe\u63a5",level:3},{value:"\u6c47\u96c6\u7279\u5b9a\u6807\u9898\u4e0b\u7684\u5185\u5bb9",id:"\u6c47\u96c6\u7279\u5b9a\u6807\u9898\u4e0b\u7684\u5185\u5bb9",level:3},{value:"\u4e0e Habit Calendar \u8054\u5408\u5e76\u4f7f\u7528\u6a21\u7248",id:"\u4e0e-habit-calendar-\u8054\u5408\u5e76\u4f7f\u7528\u6a21\u7248",level:3},{value:"\u663e\u793a\u65e5\u671f",id:"\u663e\u793a\u65e5\u671f",level:3},{value:"\ud83d\udd70\ufe0f \u65f6\u95f4\u8fdb\u5ea6\u4eea\u8868\u76d8",id:"\ufe0f-\u65f6\u95f4\u8fdb\u5ea6\u4eea\u8868\u76d8",level:3},{value:"\u6253\u5370\u5bf9\u8c61\u5c5e\u6027",id:"\u6253\u5370\u5bf9\u8c61\u5c5e\u6027",level:3},{value:"Tips",id:"tips",level:2},{value:"References",id:"references",level:2}];function c(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"dataview",children:"Dataview"})}),"\n",(0,t.jsx)(n.h2,{id:"metadata",children:"Metadata"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Frontmatter"}),"\n",(0,t.jsx)(n.li,{children:"Inline fields"}),"\n",(0,t.jsxs)(n.li,{children:["Implicit fields","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://blacksmithgu.github.io/obsidian-dataview/annotation/metadata-pages/",children:"Metadata on Pages - Dataview"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://blacksmithgu.github.io/obsidian-dataview/annotation/metadata-tasks/",children:"Metadata on Tasks and Lists - Dataview"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"data-types",children:"Data Types"}),"\n",(0,t.jsxs)(n.h2,{id:"dql--inline-dql",children:[(0,t.jsx)(n.a,{href:"https://blacksmithgu.github.io/obsidian-dataview/queries/structure/",children:"DQL"})," & Inline DQL"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataview-",children:"<QUERY-TYPE> <fields>\nFROM <source>\n<DATA-COMMAND> <expression>\n<DATA-COMMAND> <expression>\n          ...\n"})}),"\n",(0,t.jsx)(n.h3,{id:"query-types",children:(0,t.jsx)(n.a,{href:"https://blacksmithgu.github.io/obsidian-dataview/queries/query-types/",children:"Query Types"})}),"\n",(0,t.jsx)(n.h4,{id:"list",children:"LIST"}),"\n",(0,t.jsx)(n.h4,{id:"table",children:"TABLE"}),"\n",(0,t.jsx)(n.h4,{id:"task",children:"TASK"}),"\n",(0,t.jsx)(n.h4,{id:"calendar",children:"CALENDAR"}),"\n",(0,t.jsx)(n.h3,{id:"query-sources",children:"Query Sources"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Tags"}),"\n",(0,t.jsx)(n.li,{children:"Folders"}),"\n",(0,t.jsx)(n.li,{children:"Specific Files"}),"\n",(0,t.jsx)(n.li,{children:"Links"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["\u5176\u4e2d\u6587\u4ef6\u5939\u548c\u8def\u5f84\u9700\u8981\u52a0\u53cc\u5f15\u53f7.",(0,t.jsx)(n.br,{}),"\n","\u591a\u4e2a\u6765\u6e90\u53ef\u4ee5\u7528 and or \u548c\u62ec\u53f7\u7ec4\u5408."]}),"\n",(0,t.jsx)(n.h3,{id:"data-commands",children:(0,t.jsx)(n.a,{href:"https://blacksmithgu.github.io/obsidian-dataview/queries/data-commands/",children:"Data Commands"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["FROM","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"#tag"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:'"folder"'})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:'"path/to/file"'})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"[[note]]"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"outgoing([[note]])"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"WHERE"}),"\n",(0,t.jsx)(n.li,{children:"SORT"}),"\n",(0,t.jsx)(n.li,{children:"GROUP BY"}),"\n",(0,t.jsx)(n.li,{children:"FLATTEN"}),"\n",(0,t.jsx)(n.li,{children:"LIMIT"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"expressions",children:"Expressions"}),"\n",(0,t.jsx)(n.h3,{id:"literals",children:"Literals"}),"\n",(0,t.jsx)(n.h3,{id:"functions",children:(0,t.jsx)(n.a,{href:"https://blacksmithgu.github.io/obsidian-dataview/reference/functions/",children:"Functions"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Constructors","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"object"}),"\n",(0,t.jsx)(n.li,{children:"list"}),"\n",(0,t.jsx)(n.li,{children:"date"}),"\n",(0,t.jsx)(n.li,{children:"dur"}),"\n",(0,t.jsx)(n.li,{children:"number"}),"\n",(0,t.jsx)(n.li,{children:"string"}),"\n",(0,t.jsx)(n.li,{children:"link"}),"\n",(0,t.jsx)(n.li,{children:"embed"}),"\n",(0,t.jsx)(n.li,{children:"elink"}),"\n",(0,t.jsx)(n.li,{children:"typeof"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"Numberic"}),"\n",(0,t.jsx)(n.li,{children:"Objects, Arrays, String"}),"\n",(0,t.jsx)(n.li,{children:"String"}),"\n",(0,t.jsx)(n.li,{children:"Utility"}),"\n"]}),"\n",(0,t.jsxs)(n.h2,{id:"dataviewjs--inline-dataviewjs",children:[(0,t.jsx)(n.a,{href:"https://blacksmithgu.github.io/obsidian-dataview/api/intro/",children:"DataviewJS"})," & Inline DataviewJS"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"dv.current"}),"\n",(0,t.jsx)(n.li,{children:"dv.pages"}),"\n",(0,t.jsx)(n.li,{children:"dv.pagePaths"}),"\n",(0,t.jsx)(n.li,{children:"dv.page"}),"\n",(0,t.jsx)(n.li,{children:"dv.el"}),"\n",(0,t.jsx)(n.li,{children:"dv.header"}),"\n",(0,t.jsx)(n.li,{children:"dv.paragraph"}),"\n",(0,t.jsx)(n.li,{children:"dv.span"}),"\n",(0,t.jsx)(n.li,{children:"dv.execute"}),"\n",(0,t.jsx)(n.li,{children:"dv.executeJs"}),"\n",(0,t.jsx)(n.li,{children:"dv.view"}),"\n",(0,t.jsx)(n.li,{children:"dv.list"}),"\n",(0,t.jsx)(n.li,{children:"dv.taskList"}),"\n",(0,t.jsx)(n.li,{children:"dv.table"}),"\n",(0,t.jsx)(n.li,{children:"dv.markdownTable"}),"\n",(0,t.jsx)(n.li,{children:"dv.markdownList"}),"\n",(0,t.jsx)(n.li,{children:"dv.markdownTaskList"}),"\n",(0,t.jsx)(n.li,{children:"dv.array"}),"\n",(0,t.jsx)(n.li,{children:"dv.fileLink"}),"\n",(0,t.jsx)(n.li,{children:"dv.sectionLink"}),"\n",(0,t.jsx)(n.li,{children:"dv.blockLink"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(n.h3,{id:"\u6b63\u53cd\u94fe",children:"\u6b63\u53cd\u94fe"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataview",children:"list\nfrom [[obsidian-dataview]]\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataview",children:"list\nfrom outgoing([[obsidian-dataview]])\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u4efb\u52a1",children:"\u4efb\u52a1"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataview",children:'TASK\nWHERE !completed AND contains(tags, "#task")\nGROUP BY file.link\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u65e5\u5386",children:"\u65e5\u5386"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataview",children:"CALENDAR file.mtime\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataviewjs",children:"const months = Array.from({ length: 12 }, (_, i) => \n    `M${(i + 1).toString().padStart(2, '0')}`\n);\n\nconst weeks = Array.from({ length: 52 }, (_, i) => \n    `W${(i + 1).toString().padStart(2, '0')}`\n);\n\nconst result = [\n    months.join(' ') + '  ',\n    ...Array.from({ length: 4 }, (_, i) => weeks.slice(i * 13, (i + 1) * 13).join(' ') + '  ')\n].join('\\n')\n\ndv.paragraph(result);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u5217\u4e3e\u4e66\u7b7e\u6587\u4ef6",children:"\u5217\u4e3e\u4e66\u7b7e\u6587\u4ef6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataview",children:'list\nrows.file.link\nwhere file.starred and file.folder\ngroup by split(file.folder, "/")[0]\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u5217\u4e3e\u6807\u7b7e",children:"\u5217\u4e3e\u6807\u7b7e"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataview",children:'TABLE WITHOUT ID\n  tag,\n  length(rows) AS count,\n  join(map(rows.file.link, (f) => f), ", ") AS files\nFROM ""\nFLATTEN file.tags AS tag\nGROUP BY tag\nSORT tag ASC\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u4ec5\u5217\u4e3e\u6839\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6",children:"\u4ec5\u5217\u4e3e\u6839\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataviewjs",children:'var files = app.vault.getFiles().filter(f => f.parent.path == "/" && !["sortspec", "Vault", "broken links output"].some(s => f.name.includes(s))).sort((a,b)=>a.name.localeCompare(b.name));\n//console.log(files);\ndv.list(files.map(f => dv.fileLink(f.path)));\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u5217\u4e3e\u7279\u5b9a\u6df1\u5ea6\u7684\u76ee\u5f55\u7ed3\u6784",children:"\u5217\u4e3e\u7279\u5b9a\u6df1\u5ea6\u7684\u76ee\u5f55\u7ed3\u6784"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"^([^\\/]+).*$"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"^([^\\/]+\\/[^\\/]+).*$"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"^([^\\/]+\\/[^\\/]+\\/[^\\/]+).*$"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataview",children:'LIST\nFROM "" AND -"Ext"\nFLATTEN regexreplace(file.folder, "^([^\\/]+\\/[^\\/]+).*$", "$1") as folder\nWHERE folder !=""\nGROUP BY folder\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u6700\u8fd1\u4fee\u6539\u7684\u6587\u4ef6",children:"\u6700\u8fd1\u4fee\u6539\u7684\u6587\u4ef6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataview",children:'TABLE length(rows) as count, choice(length(rows)>10,join(map(rows.new_title, (f) => f), ", "),rows.new_title) AS files\nWHERE date(today) - file.mtime <= dur(30 days)\nWHERE !econtains(["temp", "sortspec", "broken links output"], file.name) and !startswith(file.path, "Misc/")\nSORT file.mtime DESC\nLIMIT 100\nFLATTEN choice(title and title!=file.name, file.link+" "+title, file.link) as new_title\nGROUP BY file.mday as date\nSORT date DESC\nLIMIT 5\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u6240\u6709\u6587\u4ef6\u6309\u6587\u4ef6\u5939\u5206\u7ec4",children:"\u6240\u6709\u6587\u4ef6\u6309\u6587\u4ef6\u5939\u5206\u7ec4"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataview",children:'table rows.new_title as filename, rows.file.cday as created, rows.file.mday as modified\nfrom "" and -"Misc" and -"Ext"\nwhere !econtains(["sortspec", "broken links output"], file.name)\nsort file.name, created desc, modified desc\nflatten choice(title and title!=file.name, file.link+" "+title, file.link) as new_title\ngroup by "`" + file.folder + "`" as folder\nsort file.folder\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u6240\u6709\u6587\u4ef6\u6309\u5f53\u524d\u6587\u4ef6\u5939\u4e0b\u7684\u5b50\u6587\u4ef6\u5939\u5206\u7ec4",children:"\u6240\u6709\u6587\u4ef6\u6309\u5f53\u524d\u6587\u4ef6\u5939\u4e0b\u7684\u5b50\u6587\u4ef6\u5939\u5206\u7ec4"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataviewjs",children:"const fs = require('fs')\n\nvar basedir = app.vault.adapter.basePath\nvar currentdir = dv.current().file.folder\nvar subfolders = fs.readdirSync(`${basedir}/${currentdir}`)\nsubfolders.sort((a,b)=>a.localeCompare(b))\n\nfor (let d of subfolders){\n    let p = `${basedir}/${currentdir}/${d}`\n    if (fs.statSync(p).isDirectory()){\n        dv.header(2, d)\n        dv.list(dv.pages(`\"${currentdir}/${d}\"`).where(p=>p.file.name != 'sortspec').sort(p=>p.file.name, 'asc').file.link)\n    }\n}\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataviewjs",children:"const fs = require('fs')\nconst base = app.vault.adapter.basePath\nconst curDir = dv.current().file.folder\nconst fullPath = `${base}/${curDir}`\n\nconst tableData = fs.readdirSync(fullPath)\n    .filter(name => fs.statSync(`${fullPath}/${name}`).isDirectory())\n    .sort((a, b) => a.localeCompare(b))\n    .map(dir => {\n        const pages = dv.pages(`\"${curDir}/${dir}\"`).where(p => p.file.name !== 'sortspec')\n        return [\n            dir,\n            pages.values.length,\n            pages.sort(p => p.file.name, 'asc').file.link.join(', ')\n        ]\n    })\n\ndv.table(['dir', 'count', 'files'], tableData)\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataviewjs",children:"const targetDir = dv.current().file.folder;\nconst currentDepth = targetDir.split('/').length;\n\nconst tableData = app.vault.getAllFolders()\n    .filter(folder => {\n        const parts = folder.path.split('/')\n        return (\n            parts.length === currentDepth + 1 && \n            folder.path.startsWith(targetDir ? `${targetDir}/` : '')\n        )\n    })\n    .sort((a, b) => a.name.localeCompare(b.name))\n    .map(folder => {\n        const pages = dv.pages(`\"${folder.path}\"`).where(p => p.file.name !== 'sortspec')\n        return [\n            `${folder.name}`,\n            pages.values.length,\n            pages.sort(p => p.file.name, 'asc').file.link.join(', ')\n        ]\n    });\n\ndv.table(['dir', 'count', 'files'], tableData);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u5217\u4e3e\u5f53\u524d\u76ee\u5f55\u4e0b\u7279\u5b9a\u6587\u4ef6\u540d\u7684\u6587\u4ef6-\u5e76\u7528-callout-\u663e\u793a\u5176\u5185\u5bb9",children:"\u5217\u4e3e\u5f53\u524d\u76ee\u5f55\u4e0b\u7279\u5b9a\u6587\u4ef6\u540d\u7684\u6587\u4ef6, \u5e76\u7528 callout \u663e\u793a\u5176\u5185\u5bb9"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataviewjs",children:'dv.pages(\'\').where(p=>dv.func.contains(p.file.folder, dv.current().file.folder)).where(p=>dv.func.regexmatch("^[0-9]{8,15}.*", p.file.name)).sort(p=>p.file.name, "desc").limit(30).forEach(p=>{\n    dv.paragraph(`\n>[!cite]- ${p.file.link} : ${p.title?p.title:""} : ${p.description?p.description:""}\n>![[${p.file.link.path} | clean no-title]]\n    `);\n})\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u5728\u5355\u6587\u4ef6\u65e5\u8bb0\u4e2d\u4f7f\u7528-flatten",children:"\u5728\u5355\u6587\u4ef6\u65e5\u8bb0\u4e2d\u4f7f\u7528 flatten"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataview",children:'table without id\nsplit(meta(L.section).subpath, " ")[0] as week,\ndateformat(L.date, "MM/dd ccc") as date, L.weather as weather, L.mood as mood, L.habits as habits, choice(L.summary, L.summary+"<br>", "")+join(L.children.text,"<br>") as summary\nwhere file.path = this.file.path\nflatten file.lists as L\nwhere L.summary or L.habits or L.children\nsort L.date desc\nlimit 30\n'})}),"\n",(0,t.jsx)(n.h3,{id:"dvjs-\u624b\u52a8\u6784\u9020\u6570\u636e",children:"dvjs \u624b\u52a8\u6784\u9020\u6570\u636e"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataviewjs",metastring:'unwrap:false title:"dataviewjs example"',children:'//console.log(dv)\n\nconst keys = ["text", "date", "number"]\nconst values = [\n    ["text1", "2023-01-10", 10],\n    ["text2", "2023-09-10", 200],\n    ["text2", "2023-01-10", 10],\n    ["text1", "2023-09-10", 100],\n]\n\n//dv.list(values.map(e=>e[0]))\n\n//dv.table(keys, dv.array(values).groupBy(v => v[0]).sort(g=>g.key, "desc").map(g=>[g.key, g.rows.sort(v=>v[2]).map(v=>v[1]), g.rows.sort(v=>v[2]).map(v=>v[2]), ]) )\n\nfor (let group of dv.array(values).where(p=>dv.date(p[1])<dv.date("today")).groupBy(p => dv.date(p[1]).month).sort(g=>g.key, "desc")) {\n    dv.header(3, group.key+"\u6708");\n    dv.table(keys,\n        group.rows\n            .map(v=>[v[0], dv.func.dateformat(dv.date(v[1]), "MM-dd ccc"), v[2]])\n            .sort(v=>v[2], "asc")\n    )\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u624b\u52a8\u6269\u5c55-pages",children:"\u624b\u52a8\u6269\u5c55 pages"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataviewjs",children:'var pages = dv.pages().where(p=>!p.file.folder);\n// manually add non markdown file links\npages=pages.concat(dv.array([\n    {"file": {"link": dv.func.link("Home.canvas","Home")}},\n]))\ndv.list(pages.file.link)\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u5355\u6587\u4ef6\u67e5\u8be2\u65f6\u6309\u67d0\u5b57\u6bb5\u5c55\u5e73",children:"\u5355\u6587\u4ef6\u67e5\u8be2\u65f6\u6309\u67d0\u5b57\u6bb5\u5c55\u5e73"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataviewjs",metastring:'title:"\u5bf9\u5355\u6587\u4ef6\u4e2d\u7684 inline fileds \u67e5\u8be2\u65f6\u6309\u67d0\u5b57\u6bb5\u5c55\u5e73\u4e3a\u591a\u884c"',children:'let pages = dv.pages(`"${dv.current().file.path}"`)\nconsole.log(pages)\n\n//let pages1 = pages.map(p=>[dv.func.dateformat(p.date,"MM-dd ccc"), p.weather, p.mood, p.habits, p.summary]).sort(p => p.date)\n\nlet pages2 = pages.date.map((date,i)=>[dv.func.dateformat(date, "MM-dd ccc"), pages.weather[i],pages.mood[i],pages.habits[i],pages.summary[i],]).sort(p => p.date).slice(-30)\n\ndv.table(\n    ["date", "weather", "mood", "habits", "summary"],\n    pages2\n)\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u6784\u9020\u94fe\u63a5",children:"\u6784\u9020\u94fe\u63a5"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:'$=dv.span(dv.func.link(dv.func.join(dv.func.list("#", dv.func.dateformat(dv.date("today"), "kkkk-\'W\'WW"), " (", moment().startOf("isoweek").format("MM/DD"), " ~ ", moment().endOf("isoweek").format("MM/DD"), ")"), ""), "\u672c\u5468"))'})," | ",(0,t.jsx)(n.code,{children:'\\=link("#"+dateformat(date(today), "yyyy-MM"), "\u672c\u6708")'})]}),"\n",(0,t.jsx)(n.h3,{id:"\u6c47\u96c6\u7279\u5b9a\u6807\u9898\u4e0b\u7684\u5185\u5bb9",children:"\u6c47\u96c6\u7279\u5b9a\u6807\u9898\u4e0b\u7684\u5185\u5bb9"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataviewjs",children:"// Headings you would like to summarise the text for\n// \u6ce8\u610f\u6807\u9898\u524d\u540e\u4e0d\u80fd\u6709\u591a\u4f59\u7684\u7a7a\u683c, \u524d\u540e\u5e94\u6709\u7a7a\u884c\nconst headings = ['Context', 'Habit']\n\n// \u4fee\u6539\u8fd9\u91cc\nconst pages = dv.pages('\"Journals\"').where(p=>dv.func.contains(p.file.folder, dv.current().file.folder)).where(p=>dv.func.regexmatch(\"[0-9]{4}-[0-9]{2}\", p.file.name)).sort(p=>p.file.name, 'desc').limit(12)\n\nconst output = {}\nheadings.forEach(x => output[x] = [])\nfor (const page of pages) {\n  const file = app.vault.getAbstractFileByPath(page.file.path)\n  // Read the file contents\n  const contents = await app.vault.read(file)\n  for (let heading of headings) {\n    // Sanitise the provided heading to use in a regex\n    heading = heading.replace(/[/\\-\\\\^$*+?.()|[\\]{}]/g, '\\\\$&')\n    const regex = `(?<=^|\\n)#+ ${heading}\\r?\\n(.*?)(?=\\n#+ |\\n---|$)`\n    // Extract the summary\n    for (const block of contents.match(new RegExp(regex, 'isg')) || []) {\n      const match = block.match(new RegExp(regex, 'is'))\n      output[heading].push({\n        title: page.file.link,\n        text: match[1].trim()\n      })\n    }\n  }\n}\nObject.keys(output).forEach(heading => {\n  dv.header(2, heading)\n  output[heading].forEach(entry => {\n    dv.header(3, entry.title)\n    dv.paragraph(entry.text)\n  })\n})\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u4e0e-habit-calendar-\u8054\u5408\u5e76\u4f7f\u7528\u6a21\u7248",children:"\u4e0e Habit Calendar \u8054\u5408\u5e76\u4f7f\u7528\u6a21\u7248"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataviewjs-",children:'const data = [\n    //{date: "2024-06-01", content: "666/111"},\n]\n<%*\nvar title = tp.file.title;\nif (/[0-9]{4}-[0-9]{2}/.test(title)) {\n    var [year, month, day] = title.split(\'-\')\n} else {\n    var now = new Date();\n    var year = now.getFullYear();\n    var month = now.getMonth()+1;\n}\nvar output = `\nconst year = "${year}";\nconst month = "${month}";\n`\ntR += output\n%>\ntry{//Habit Calendar Plugin\nrenderHabitCalendar(this.container, dv, {\n    year,\n    month,\n    data: data.filter((function(e){return e["date"].startsWith(`${year}-${month.toString().padStart(2,0)}`)})),\n})}catch(e){console.log(e)}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u663e\u793a\u65e5\u671f",children:"\u663e\u793a\u65e5\u671f"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataviewjs",children:'dv.paragraph(`\u73b0\u5728\u662f ${moment().format(\'GGGG\u5e74\u7b2cW\u5468\')} `+\n  new Intl.DateTimeFormat("zh-CN", {\n    dateStyle: "full",\n    timeStyle: "long",\n    hour12: true\n  }).format(new Date()),\n);\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataviewjs",children:"//console.log(`${moment().format('\u73b0\u5728\u662f: NYYYY\u5e74M\u6708D\u65e5 [W]W-dddd AHH\u65f6mm\u5206ss\u79d2(Z)')}`);\n\n(() => {\n    const now = new Date();\n    const isoWeek = ((date) => {\n        const d = new Date(date);\n        d.setDate(d.getDate() + 3 - ((d.getDay() + 6) % 7));\n        return Math.floor((d - new Date(d.getFullYear(), 0, 1)) / 6048e5) + 1;\n    })(now);\n\n    const options = {\n        era: 'short',\n        year: 'numeric',\n        month: 'numeric',\n        day: 'numeric',\n        weekday: 'long',\n        dayPeriod: 'short',\n        hour12: true,\n        hour: 'numeric',\n        minute: 'numeric',\n        second: 'numeric',\n        timeZoneName: \"shortGeneric\",\n    }\n\n    const parts = Object.fromEntries(\n        new Intl.DateTimeFormat(\"zh-CN\", options)\n            .formatToParts(now)\n            .filter((p) => Object.keys(options).includes(p.type))\n            .map((p) => [p.type, p.value])\n    );\n\n    dv.paragraph(`\u73b0\u5728\u662f: ${parts.timeZoneName} ${parts.era}${parts.year}\u5e74${parts.month}\u6708${parts.day}\u65e5 ${parts.weekday}(\u7b2c${isoWeek}\u5468) ${parts.dayPeriod}${parts.hour}\u65f6${parts.minute}\u5206`)\n})()\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\ufe0f-\u65f6\u95f4\u8fdb\u5ea6\u4eea\u8868\u76d8",children:"\ud83d\udd70\ufe0f \u65f6\u95f4\u8fdb\u5ea6\u4eea\u8868\u76d8"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataviewjs",children:'// ===== \u5de5\u5177\u51fd\u6570 =====\nfunction \u83b7\u53d6\u5f53\u524d\u65e5\u671f() {\n    return new Date();\n}\n\nfunction \u751f\u6210\u8fdb\u5ea6\u6761(\u767e\u5206\u6bd4, \u957f\u5ea6 = 20) {\n    const \u5b8c\u6210\u683c\u5b50\u6570 = Math.floor(\u767e\u5206\u6bd4 / 100 * \u957f\u5ea6);\n    const \u5269\u4f59\u683c\u5b50 = \u957f\u5ea6 - \u5b8c\u6210\u683c\u5b50\u6570;\n    \n    // \u7ea2\u7eff\u706f\u4e09\u8272:\n    const \u989c\u8272 = \n        \u767e\u5206\u6bd4 > 70 ? "#4CAF50" :  // \u7eff(\u5b89\u5168)\n        \u767e\u5206\u6bd4 > 40 ? "#FFC107" :  // \u9ec4(\u8b66\u544a)\n        "#F44336";                // \u7ea2(\u5371\u9669)\n\n    return `\u2502<span style="color:${\u989c\u8272}">${"\u2588".repeat(\u5b8c\u6210\u683c\u5b50\u6570)}</span>` +\n           `<span style="color:#E0E0E0">${"\u2591".repeat(\u5269\u4f59\u683c\u5b50)}</span>\u2502`;\n}\n\n// ===== \u4e3b\u8ba1\u7b97\u903b\u8f91 =====\nconst \u5f53\u524d\u65e5\u671f = \u83b7\u53d6\u5f53\u524d\u65e5\u671f();\nconst \u5f53\u524d\u5e74\u4efd = \u5f53\u524d\u65e5\u671f.getFullYear();\n\n// 1. \u5e74\u8fdb\u5ea6\nconst \u5e74\u521d = new Date(\u5f53\u524d\u5e74\u4efd, 0, 1);\nconst \u5e74\u672b = new Date(\u5f53\u524d\u5e74\u4efd, 11, 31);\nconst \u5168\u5e74\u5929\u6570 = Math.floor((\u5e74\u672b - \u5e74\u521d) / 86400000) + 1;\nconst \u5df2\u8fc7\u5929\u6570 = Math.floor((\u5f53\u524d\u65e5\u671f - \u5e74\u521d) / 86400000) + 1;\nconst \u5e74\u8fdb\u5ea6\u767e\u5206\u6bd4 = (\u5df2\u8fc7\u5929\u6570 / \u5168\u5e74\u5929\u6570 * 100).toFixed(1);\nconst \u5269\u4f59\u5929\u6570 = \u5168\u5e74\u5929\u6570 - \u5df2\u8fc7\u5929\u6570;\n\n// 2. \u6708\u8fdb\u5ea6\nconst \u5f53\u6708\u5929\u6570 = new Date(\u5f53\u524d\u5e74\u4efd, \u5f53\u524d\u65e5\u671f.getMonth() + 1, 0).getDate();\nconst \u5df2\u8fc7\u5f53\u6708\u5929\u6570 = \u5f53\u524d\u65e5\u671f.getDate();\nconst \u6708\u8fdb\u5ea6\u767e\u5206\u6bd4 = (\u5df2\u8fc7\u5f53\u6708\u5929\u6570 / \u5f53\u6708\u5929\u6570 * 100).toFixed(1);\nconst \u5269\u4f59\u5f53\u6708\u5929\u6570 = \u5f53\u6708\u5929\u6570 - \u5df2\u8fc7\u5f53\u6708\u5929\u6570;\n\n// 3. \u5468\u8fdb\u5ea6\nconst \u672c\u5468\u7b2c\u51e0\u5929 = \u5f53\u524d\u65e5\u671f.getDay(); // 0=\u5468\u65e5\nconst \u5df2\u8fc7\u5468\u5929\u6570 = \u672c\u5468\u7b2c\u51e0\u5929 === 0 ? 6 : \u672c\u5468\u7b2c\u51e0\u5929 - 1; // \u5468\u4e00\u4e3a 0 \u2192 \u5468\u65e5\u4e3a 6\nconst \u5468\u8fdb\u5ea6\u767e\u5206\u6bd4 = ((\u5df2\u8fc7\u5468\u5929\u6570 + 1) / 7 * 100).toFixed(1); // +1 \u56e0\u4e3a\u5f53\u5929\u4e5f\u7b97\u5df2\u8fc7\nconst \u5269\u4f59\u5468\u5929\u6570 = 6 - \u5df2\u8fc7\u5468\u5929\u6570;\n\n// ===== \u8f93\u51fa\u7ed3\u679c =====\ndv.span(`\n| \u5468\u671f  | \u8fdb\u5ea6\u767e\u5206\u6bd4 | \u8fdb\u5ea6\u6761                  | \u5df2\u8fc7\u65f6\u95f4     | \u5269\u4f59\u65f6\u95f4     | \u603b\u65f6\u957f    |\n|-------|------------|-------------------------|--------------|--------------|-----------|\n| \u2600\ufe0f \u5e74 | ${\u5e74\u8fdb\u5ea6\u767e\u5206\u6bd4}%  | ${\u751f\u6210\u8fdb\u5ea6\u6761(\u5e74\u8fdb\u5ea6\u767e\u5206\u6bd4)} | ${\u5df2\u8fc7\u5929\u6570}\u5929  | ${\u5269\u4f59\u5929\u6570}\u5929  | ${\u5168\u5e74\u5929\u6570}\u5929 |\n| \ud83c\udf19 \u6708 | ${\u6708\u8fdb\u5ea6\u767e\u5206\u6bd4}%  | ${\u751f\u6210\u8fdb\u5ea6\u6761(\u6708\u8fdb\u5ea6\u767e\u5206\u6bd4)} | ${\u5df2\u8fc7\u5f53\u6708\u5929\u6570}\u5929 | ${\u5269\u4f59\u5f53\u6708\u5929\u6570}\u5929 | ${\u5f53\u6708\u5929\u6570}\u5929  |\n| \u2b50 \u5468 | ${\u5468\u8fdb\u5ea6\u767e\u5206\u6bd4}%  | ${\u751f\u6210\u8fdb\u5ea6\u6761(\u5468\u8fdb\u5ea6\u767e\u5206\u6bd4)} | ${\u5df2\u8fc7\u5468\u5929\u6570+1}\u5929  | ${\u5269\u4f59\u5468\u5929\u6570}\u5929  | 7 \u5929       |\n`);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u6253\u5370\u5bf9\u8c61\u5c5e\u6027",children:"\u6253\u5370\u5bf9\u8c61\u5c5e\u6027"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-dataviewjs",children:"// \u6253\u5370\u5bf9\u8c61\u5c5e\u6027\n(() => {\n    const obj = app;\n    const own = Object.getOwnPropertyNames(obj);\n    const proto = Object.getPrototypeOf(obj);\n    \n    dv.paragraph('own');\n    let ownData = own.sort((a, b) => a.localeCompare(b)).map(p => ({\n        name: p,\n        type: typeof obj[p],\n    }));\n    dv.table(['name', 'type'], ownData.map(p=>[p.name, p.type]));\n    \n    dv.paragraph('proto');\n    let protoData = Object.getOwnPropertyNames(proto).sort((a, b) => a.localeCompare(b)).map(p => ({\n        name: p,\n        type: typeof proto[p],\n    }));\n    dv.table(['name', 'type'], protoData.map(p=>[p.name, p.type]));\n    \n})();\n"})}),"\n",(0,t.jsx)(n.h2,{id:"tips",children:"Tips"}),"\n",(0,t.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://s-blu.github.io/obsidian_dataview_example_vault/",children:"Dataview Example Vault"})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453(e,n,a){a.d(n,{R:()=>s,x:()=>r});var i=a(96540);const t={},l=i.createContext(t);function s(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);