"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[682],{28453(n,e,i){i.d(e,{R:()=>a,x:()=>d});var l=i(96540);const s={},t=l.createContext(s);function a(n){const e=l.useContext(t);return l.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:a(n.components),l.createElement(t.Provider,{value:e},n.children)}},59874(n,e,i){i.r(e),i.d(e,{assets:()=>r,contentTitle:()=>d,default:()=>o,frontMatter:()=>a,metadata:()=>l,toc:()=>p});const l=JSON.parse('{"id":"Computer/Application/Obsidian/obsidian-better-plugins-manager","title":"Better Plugins Manager","description":"\u529f\u80fd","source":"@site/vault/docs/Computer/90_Application/Obsidian/obsidian-better-plugins-manager.md","sourceDirName":"Computer/90_Application/Obsidian","slug":"/Computer/Application/Obsidian/obsidian-better-plugins-manager","permalink":"/docs/Computer/Application/Obsidian/obsidian-better-plugins-manager","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Obsidian/Plugins","permalink":"/docs/tags/obsidian-plugins"}],"version":"current","lastUpdatedAt":1768143256000,"frontMatter":{"title":"Better Plugins Manager","modified":"2025-10-08T21:29","tags":["Obsidian/Plugins"],"aliases":["Better Plugins Manager"],"url":["https://github.com/Obsidian-Forge/obsidian-manager"],"date":"2025-02-15T17:09"},"sidebar":"obsidianSidebar","previous":{"title":"Obsidian Bases","permalink":"/docs/Computer/Application/Obsidian/obsidian-bases"},"next":{"title":"Commander","permalink":"/docs/Computer/Application/Obsidian/obsidian-commander"}}');var s=i(74848),t=i(28453);const a={title:"Better Plugins Manager",modified:"2025-10-08T21:29",tags:["Obsidian/Plugins"],aliases:["Better Plugins Manager"],url:["https://github.com/Obsidian-Forge/obsidian-manager"],date:"2025-02-15T17:09"},d="Better Plugins Manager",r={},p=[{value:"\u529f\u80fd",id:"\u529f\u80fd",level:2},{value:"\u914d\u7f6e",id:"\u914d\u7f6e",level:2},{value:"\u89e3\u6790",id:"\u89e3\u6790",level:2},{value:"Tips",id:"tips",level:2},{value:"lazy-to-bpm",id:"lazy-to-bpm",level:2}];function g(n){const e={blockquote:"blockquote",code:"code",del:"del",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"better-plugins-manager",children:"Better Plugins Manager"})}),"\n",(0,s.jsx)(e.h2,{id:"\u529f\u80fd",children:"\u529f\u80fd"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u8fc7\u6ee4"}),"\n",(0,s.jsx)(e.li,{children:"\u5b89\u88c5"}),"\n",(0,s.jsx)(e.li,{children:"\u5f00\u5173"}),"\n",(0,s.jsx)(e.li,{children:"\u5ef6\u8fdf\u542f\u52a8"}),"\n",(0,s.jsx)(e.li,{children:"\u8bbe\u7f6e"}),"\n",(0,s.jsx)(e.li,{children:"\u5feb\u6377\u952e"}),"\n",(0,s.jsx)(e.li,{children:"\u66f4\u65b0"}),"\n",(0,s.jsx)(e.li,{children:"\u5378\u8f7d"}),"\n",(0,s.jsx)(e.li,{children:"\u4e3b\u9875"}),"\n",(0,s.jsx)(e.li,{children:"\u7b14\u8bb0"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"\u914d\u7f6e",children:"\u914d\u7f6e"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["GROUPS","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"default"}),"\n",(0,s.jsx)(e.li,{children:"\u672c\u4f53\u7c7b main %% \u4f5c\u7528\u4e8e\u672c\u4f53\u754c\u9762 %%"}),"\n",(0,s.jsx)(e.li,{children:"\u7f16\u8f91\u7c7b edit %% \u5185\u5bb9\u7f16\u8f91 %%"}),"\n",(0,s.jsx)(e.li,{children:"\u6269\u5c55\u7c7b ext %% \u6269\u5c55\u4e86\u65b0\u7684\u529f\u80fd\u6216\u63a5\u53e3 %%"}),"\n",(0,s.jsx)(e.li,{children:"\u8f85\u52a9\u7c7b aux %% \u4f4e\u9891\u5468\u8fb9 %%"}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.del,{children:"\u5907\u7528\u5f85\u5b9a"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["TAGS","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"default"}),"\n",(0,s.jsx)(e.li,{children:"\u5fc5\u5907 required"}),"\n",(0,s.jsx)(e.li,{children:"\u63a8\u8350 recommended %% \u91cd\u8981\u4f46\u4e0d\u4e00\u5b9a\u5fc5\u8981 %%"}),"\n",(0,s.jsx)(e.li,{children:"\u53ef\u9009 optional %% \u975e\u5fc5\u8981&\u4e0d\u91cd\u8981 %%"}),"\n",(0,s.jsx)(e.li,{children:"\u5907\u7528 reserved %% \u6682\u4e0d\u9700\u8981 %%"}),"\n",(0,s.jsx)(e.li,{children:"\u5f85\u5b9a undetermined"}),"\n",(0,s.jsx)(e.li,{children:"\u4e0d\u63a8\u8350 deprecated"}),"\n",(0,s.jsx)(e.li,{children:"beta"}),"\n",(0,s.jsx)(e.li,{children:"bug"}),"\n",(0,s.jsx)(e.li,{children:"lag"}),"\n",(0,s.jsx)(e.li,{children:"dev %% \u8c03\u8bd5 %%"}),"\n",(0,s.jsx)(e.li,{children:"config %% \u914d\u7f6e\u590d\u6742 %%"}),"\n",(0,s.jsx)(e.li,{children:"risk %% \u98ce\u9669 %%"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["DELAYS %% \u5efa\u8bae id \u7b49\u4e8e\u503c %%","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"default 0"}),"\n",(0,s.jsx)(e.li,{children:"instant 0"}),"\n",(0,s.jsx)(e.li,{children:"short 5"}),"\n",(0,s.jsx)(e.li,{children:"middle 10"}),"\n",(0,s.jsx)(e.li,{children:"long 15"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Plugins (Manifest):","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"id, name, desc, group, tags, enabled, delay, note"}),"\n",(0,s.jsx)(e.li,{children:"version"}),"\n",(0,s.jsx)(e.li,{children:"author"}),"\n",(0,s.jsx)(e.li,{children:"repo"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"\u89e3\u6790",children:"\u89e3\u6790"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-dataviewjs",children:'const bpmSettings = app.plugins.plugins["better-plugins-manager"].settings;\nconst groupsMap = Object.fromEntries(\n  bpmSettings.GROUPS.map((item) => [item.id, item.name])\n);\nconst tagsMap = Object.fromEntries(\n  bpmSettings.TAGS.map((item) => [item.id, item.name])\n);\nconst delaysMap = Object.fromEntries(\n  bpmSettings.DELAYS.map((item) => [item.id, item.time])\n);\n\nfunction renderList(plugins) {\n  dv.list(\n    (plugins || bpmSettings.Plugins)\n      .sort((a, b) => a.id.localeCompare(b.id))\n      .map((p) => `${p.id}`)\n  );\n}\n\nfunction renderTable(plugins) {\n  dv.table(\n    ["id", "group", "tags", "delay", "enabled", "note"],\n    (plugins || bpmSettings.Plugins).sort((a, b) => a.id.localeCompare(b.id)).map((p) => [\n      p.id,\n      groupsMap[p.group],\n      p.tags.map(tag=>tagsMap[tag]).join(","),\n      delaysMap[p.delay],\n      p.enabled ? p.enabled : `**${p.enabled}**`,\n      p.note,\n    ])\n  );\n}\n\nfunction renderByGroups() {\n  // \u5206\u7ec4\u6536\u96c6(\u542b\u672a\u5206\u7ec4)\n  const grouped = bpmSettings.Plugins.reduce((acc, p) => {\n    const key = p.group ?? "\u672a\u5206\u7ec4";\n    (acc[key] ??= []).push(p);\n    return acc;\n  }, {});\n\n  // \u6309\u914d\u7f6e\u987a\u5e8f\u6e32\u67d3\n  bpmSettings.GROUPS.forEach((g) => {\n    grouped[g.id]?.length && dv.header(3, g.name) && renderTable(grouped[g.id]);\n  });\n\n  // \u5904\u7406\u672a\u5206\u7ec4(\u72ec\u7acb\u4e8e\u914d\u7f6e)\n  grouped.\u672a\u5206\u7ec4?.length &&\n    dv.header(3, "\u672a\u5206\u7ec4") &&\n    renderTable(grouped.\u672a\u5206\u7ec4);\n}\n\nfunction renderByTags() {\n  // \u6807\u7b7e\u5206\u7ec4\u6536\u96c6\n  const tagged = bpmSettings.Plugins.reduce((acc, p) => {\n    p.tags?.forEach((t) => (acc[t] ??= []).push(p));\n    return acc;\n  }, {});\n\n  // \u6309\u914d\u7f6e\u987a\u5e8f\u6e32\u67d3\n  bpmSettings.TAGS.forEach((t) => {\n    tagged[t.id]?.length && dv.header(3, t.name) && renderTable(tagged[t.id]);\n  });\n}\n\nrenderByGroups()\n//renderByTags()\n'})}),"\n",(0,s.jsx)(e.h2,{id:"tips",children:"Tips"}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"[!tip]+ \u53f3\u952e -> \u7b14\u8bb0\u3001\u5feb\u6377\u952e\u3001GitHub"}),"\n"]}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"[!attention]+ \u5c3d\u91cf\u5728\u672c\u63d2\u4ef6\u4e2d\u5f00\u5173\u63d2\u4ef6, \u907f\u514d\u76f4\u63a5\u5728\u8bbe\u7f6e\u4e2d\u64cd\u4f5c. (\u5982\u679c\u63d2\u4ef6\u5b58\u7559\u5728 community-plugins.json \u4e2d\u5219\u5ef6\u65f6\u542f\u52a8\u65e0\u6548.)"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\u82e5\u5728\u672c\u63d2\u4ef6\u4e2d off","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5728\u63d2\u4ef6\u4e2d on, \u91cd\u542f\u540e on"}),"\n",(0,s.jsxs)(e.li,{children:["\u5728\u8bbe\u7f6e\u4e2d on, \u91cd\u542f\u540e ",(0,s.jsx)(e.strong,{children:"on"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\u82e5\u5728\u672c\u63d2\u4ef6\u4e2d on","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5728\u63d2\u4ef6\u4e2d off, \u91cd\u542f\u540e off"}),"\n",(0,s.jsx)(e.li,{children:"\u5728\u8bbe\u7f6e\u4e2d off, \u91cd\u542f\u540e on"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"lazy-to-bpm",children:"lazy-to-bpm"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:'import json\nimport sys\nfrom pathlib import Path\n\nclass StatusMapper:\n    # \u6309\u4f18\u5148\u7ea7\u987a\u5e8f\u5b9a\u4e49\u7684\u6807\u7b7e\u5217\u8868\n    TAGS_PRIORITY = [\n        "required",\n        "recommended",\n        "optional",\n        "reserved",\n        "undetermined",\n        "ignored",\n        "deprecated",\n    ]\n\n    # \u5bf9\u5e94\u7684\u7b26\u53f7\u5217\u8868(\u4e0eTAGS_PRIORITY\u4e00\u4e00\u5bf9\u5e94)\n    SYMBOLS = ["X", "P", "/", "+", "?", "-", "C"]\n\n    # \u4ece\u6807\u7b7e\u5230\u7b26\u53f7\u7684\u6b63\u5411\u6620\u5c04\n    TAG_TO_SYMBOL = dict(zip(TAGS_PRIORITY, SYMBOLS))\n\n    # \u4ece\u7b26\u53f7\u5230\u6807\u7b7e\u7684\u53cd\u5411\u6620\u5c04\n    SYMBOL_TO_TAG = dict(zip(SYMBOLS, TAGS_PRIORITY))\n\n    # \u9ed8\u8ba4\u72b6\u6001\u6620\u5c04(\u57fa\u4e8e enabled \u72b6\u6001)\n    DEFAULT_SYMBOLS = {\n        True: "x",  # \u542f\u7528\u72b6\u6001\u7684\u9ed8\u8ba4\u7b26\u53f7\n        False: ">",  # \u7981\u7528\u72b6\u6001\u7684\u9ed8\u8ba4\u7b26\u53f7\n    }\n\n    @classmethod\n    def get_status_symbol(cls, enabled, tags):\n        """\u6839\u636e\u63d2\u4ef6\u72b6\u6001\u548c\u6807\u7b7e\u83b7\u53d6\u72b6\u6001\u7b26\u53f7"""\n        if tags:\n            # \u6309\u7167\u4f18\u5148\u7ea7\u987a\u5e8f\u68c0\u67e5\u6807\u7b7e\n            for tag in cls.TAGS_PRIORITY:\n                if tag in tags:\n                    return cls.TAG_TO_SYMBOL[tag]\n\n        # \u5982\u679c\u6ca1\u6709\u5339\u914d\u7684\u6807\u7b7e,\u8fd4\u56de\u57fa\u4e8e enabled \u72b6\u6001\u7684\u9ed8\u8ba4\u7b26\u53f7\n        return cls.DEFAULT_SYMBOLS[enabled]\n\n    @classmethod\n    def get_tag_from_symbol(cls, symbol):\n        """\u6839\u636e\u72b6\u6001\u7b26\u53f7\u83b7\u53d6\u6807\u7b7e"""\n        # \u9996\u5148\u68c0\u67e5\u662f\u5426\u4e3a\u7279\u6b8a\u6807\u7b7e\n        if symbol in cls.SYMBOL_TO_TAG:\n            return cls.SYMBOL_TO_TAG[symbol]\n\n        # \u5982\u679c\u4e0d\u662f\u7279\u6b8a\u6807\u7b7e,\u68c0\u67e5\u662f\u5426\u4e3a\u9ed8\u8ba4\u7b26\u53f7\n        for enabled, default_symbol in cls.DEFAULT_SYMBOLS.items():\n            if symbol == default_symbol:\n                return "enabled" if enabled else "disabled"\n\n        # \u5982\u679c\u90fd\u4e0d\u662f,\u8fd4\u56de\u672a\u77e5\n        return "unknown"\n\nclass PluginManager:\n    UNGROUPED = "\u672a\u5206\u7ec4"\n\n    def __init__(self, basepath=".obsidian"):\n        self.basepath = basepath\n        self.bpm_data = self.load_config("better-plugins-manager")\n\n        # \u4f7f\u7528\u6620\u5c04\u63d0\u9ad8\u67e5\u627e\u6027\u80fd\n        self.plugins = {plugin["id"]: plugin for plugin in self.bpm_data["Plugins"]}\n        self.groups = {group["id"]: group for group in self.bpm_data["GROUPS"]}\n        self.tags = {tag["id"]: tag for tag in self.bpm_data["TAGS"]}\n        self.delays = {delay["id"]: delay for delay in self.bpm_data["DELAYS"]}\n\n    def get_config_path(self, plugin, filename="data.json"):\n        return Path(self.basepath) / "plugins" / plugin / filename\n\n    def load_config(self, plugin):\n        try:\n            with open(self.get_config_path(plugin), "r", encoding="utf-8") as file:\n                return json.load(file)\n        except Exception as e:\n            print(f"\u52a0\u8f7d\u914d\u7f6e\u51fa\u9519: {e}")\n            return None\n\n    def save_config(self, data, plugin, filename="data-modified.json"):\n        file_path = self.get_config_path(plugin, filename)\n        file_path.parent.mkdir(parents=True, exist_ok=True)\n\n        try:\n            with open(file_path, "w", encoding="utf-8") as file:\n                json.dump(data, file, indent=2, ensure_ascii=False)\n            print(f"\u914d\u7f6e\u5df2\u4fdd\u5b58: {file_path}")\n        except Exception as e:\n            print(f"\u4fdd\u5b58\u914d\u7f6e\u51fa\u9519: {e}")\n\n    def get_plugins(self, condition=None):\n        """\u83b7\u53d6\u6240\u6709\u63d2\u4ef6\u6216\u6839\u636e\u6761\u4ef6\u8fc7\u6ee4\u63d2\u4ef6"""\n        if condition is None:\n            return list(self.plugins.values())\n        elif callable(condition):\n            return [plugin for plugin in self.plugins.values() if condition(plugin)]\n        else:\n            raise ValueError("condition \u5fc5\u987b\u662f\u53ef\u8c03\u7528\u51fd\u6570\u6216 None")\n\n    def get_plugins_by_tag(self, tag):\n        """\u6839\u636e\u6807\u7b7e\u83b7\u53d6\u63d2\u4ef6"""\n        return self.get_plugins(lambda p: tag in p.get("tags", []))\n\n    def get_plugins_by_group(self, group):\n        """\u6839\u636e\u5206\u7ec4\u83b7\u53d6\u63d2\u4ef6"""\n        return self.get_plugins(lambda p: p.get("group") == group)\n\n    def get_plugins_by_enabled(self, enabled=True):\n        """\u6839\u636e\u542f\u7528\u72b6\u6001\u83b7\u53d6\u63d2\u4ef6"""\n        return self.get_plugins(lambda p: p.get("enabled", True) == enabled)\n\n    def get_plugins_by_delay(self, delay):\n        """\u6839\u636e\u5ef6\u8fdf\u8bbe\u7f6e\u83b7\u53d6\u63d2\u4ef6"""\n        return self.get_plugins(lambda p: p.get("delay") == delay)\n\n    def update_plugin_delay(self, plugins, delay=""):\n        if isinstance(plugins, str):\n            plugins = [plugins]\n\n        if delay and delay not in self.delays:\n            print(f"\u8b66\u544a: \u5ef6\u8fdf \'{delay}\' \u4e0d\u5b58\u5728")\n            return\n\n        for plugin_id in set(plugins).intersection(self.plugins):\n            self.plugins[plugin_id]["delay"] = delay\n\n    def update_plugin_group(self, plugins, group=""):\n        if isinstance(plugins, str):\n            plugins = [plugins]\n\n        if group and group not in self.groups:\n            print(f"\u8b66\u544a: \u5206\u7ec4 \'{group}\' \u4e0d\u5b58\u5728")\n            return\n\n        for plugin_id in set(plugins).intersection(self.plugins):\n            self.plugins[plugin_id]["group"] = group\n\n    def update_plugin_tags(self, plugins, tags=None, mode="replace"):\n        if isinstance(plugins, str):\n            plugins = [plugins]\n\n        if tags and any(tag not in self.tags for tag in tags):\n            print("\u8b66\u544a: \u67d0\u4e9b\u6807\u7b7e\u4e0d\u5b58\u5728")\n            return\n\n        for plugin_id in set(plugins).intersection(self.plugins):\n            current_tags = set(self.plugins[plugin_id].get("tags", []))\n\n            if not tags:  # \u6e05\u7a7a\u6807\u7b7e\n                self.plugins[plugin_id]["tags"] = []\n            elif mode == "replace":\n                self.plugins[plugin_id]["tags"] = tags.copy()\n            elif mode == "add":\n                self.plugins[plugin_id]["tags"] = list(current_tags.union(tags))\n            elif mode == "remove":\n                self.plugins[plugin_id]["tags"] = list(current_tags - set(tags))\n\n    def add_plugin_tags(self, plugins, tags):\n        self.update_plugin_tags(plugins, tags, "add")\n\n    def remove_plugin_tags(self, plugins, tags):\n        self.update_plugin_tags(plugins, tags, "remove")\n\n    def clear_plugin_tags(self, plugins):\n        self.update_plugin_tags(plugins, [])\n\n    def rename_delay(self, old_id, new_id):\n        if old_id not in self.delays:\n            print(f"\u8b66\u544a: \u5ef6\u8fdfID \'{old_id}\' \u4e0d\u5b58\u5728")\n            return\n\n        # \u66f4\u65b0\u5ef6\u8fdf\n        self.delays[new_id] = self.delays[old_id]\n        self.delays[new_id]["id"] = new_id\n        del self.delays[old_id]\n\n        # \u66f4\u65b0\u63d2\u4ef6\n        for plugin in self.plugins.values():\n            if plugin.get("delay") == old_id:\n                plugin["delay"] = new_id\n\n    def rename_group(self, old_id, new_id):\n        if old_id not in self.groups:\n            print(f"\u8b66\u544a: \u5206\u7ec4ID \'{old_id}\' \u4e0d\u5b58\u5728")\n            return\n\n        # \u66f4\u65b0\u5206\u7ec4\n        self.groups[new_id] = self.groups[old_id]\n        self.groups[new_id]["id"] = new_id\n        del self.groups[old_id]\n\n        # \u66f4\u65b0\u63d2\u4ef6\n        for plugin in self.plugins.values():\n            if plugin.get("group") == old_id:\n                plugin["group"] = new_id\n\n    def rename_tag(self, old_id, new_id):\n        if old_id not in self.tags:\n            print(f"\u8b66\u544a: \u6807\u7b7eID \'{old_id}\' \u4e0d\u5b58\u5728")\n            return\n\n        # \u66f4\u65b0\u6807\u7b7e\n        self.tags[new_id] = self.tags[old_id]\n        self.tags[new_id]["id"] = new_id\n        del self.tags[old_id]\n\n        # \u66f4\u65b0\u63d2\u4ef6\n        for plugin in self.plugins.values():\n            if old_id in plugin.get("tags", []):\n                plugin["tags"] = [\n                    new_id if tag == old_id else tag for tag in plugin.get("tags", [])\n                ]\n\n    def lazy2bpm(self, delays_map=None):\n        # \u9ed8\u8ba4\u7684\u5ef6\u8fdf\u6620\u5c04\n        default_delays_map = {\n            "short": "5",\n            "long": "15",\n            "instant": "0",\n            "disabled": "",\n        }\n\n        # \u4f7f\u7528\u9ed8\u8ba4\u6620\u5c04\u4f5c\u4e3a\u57fa\u7840,\u7136\u540e\u7528\u4f20\u5165\u7684\u53c2\u6570\u66f4\u65b0\u5b83\n        final_delays_map = {**default_delays_map, **(delays_map or {})}\n\n        lazy_data = self.load_config("lazy-plugins")\n        if not lazy_data:\n            return self.bpm_data\n\n        lazy_plugins = lazy_data["desktop"]["plugins"]\n\n        for plugin_id, plugin in self.plugins.items():\n            if plugin_id not in lazy_plugins:\n                continue\n\n            startup_type = lazy_plugins[plugin_id]["startupType"]\n            plugin["enabled"] = startup_type != "disabled"\n\n            if startup_type in final_delays_map:\n                delay = final_delays_map[startup_type]\n                if delay and delay not in self.delays:\n                    print(f"\u8b66\u544a: \u5ef6\u8fdfID \'{delay}\' \u4e0d\u5b58\u5728")\n                    continue\n                plugin["delay"] = delay\n            else:\n                print(f"\u8b66\u544a: startupType \'{startup_type}\' \u4e0d\u5b58\u5728")\n\n        return self.bpm_data\n\n    def export_md(self, output_path=None, condition=None, extra_attrs=None):\n        """\n        \u5bfc\u51fa\u63d2\u4ef6\u5217\u8868\u5230Markdown\u683c\u5f0f\n\n        Args:\n            output_path: \u8f93\u51fa\u6587\u4ef6\u8def\u5f84,None\u8868\u793a\u6253\u5370\u5230\u63a7\u5236\u53f0\n            condition: \u63d2\u4ef6\u8fc7\u6ee4\u6761\u4ef6\u51fd\u6570\n            extra_attrs: \u989d\u5916\u5c5e\u6027\u5217\u8868,\u5982["tags", "delay"]\n        """\n        # \u83b7\u53d6\u8fc7\u6ee4\u540e\u7684\u63d2\u4ef6\n        plugins = self.get_plugins(condition)\n        plugins = sorted(plugins, key=lambda p: p["id"])\n\n        # \u6309\u5206\u7ec4\u7ec4\u7ec7\u63d2\u4ef6\n        grouped_plugins = {}\n        for plugin in plugins:\n            group_id = plugin.get("group", "") or self.UNGROUPED\n            if group_id not in grouped_plugins:\n                grouped_plugins[group_id] = []\n            grouped_plugins[group_id].append(plugin)\n\n        # \u6784\u5efa\u8f93\u51fa\u5185\u5bb9\n        lines = ["# Obsidian \u63d2\u4ef6\u5217\u8868\\n\\n"]\n\n        group_index_map = {\n            group["id"]: idx for idx, group in enumerate(self.bpm_data["GROUPS"])\n        }\n\n        sorted_groups = sorted(\n            grouped_plugins.keys(),\n            key=lambda gid: (\n                0 if gid == self.UNGROUPED else 1,  # \u7279\u522b\u5904\u7406\u672a\u5206\u7ec4\n                group_index_map.get(gid, float("inf")),  # \u4e0d\u5728GROUPS\u4e2d\u7684\u5206\u7ec4\u6392\u5728\u540e\u9762\n                gid,  # \u76f8\u540c\u7d22\u5f15\u7684\u5206\u7ec4\u6309\u5b57\u6bcd\u987a\u5e8f\u6392\u5e8f\n            ),\n        )\n\n        for group_id in sorted_groups:\n            group_info = self.groups.get(group_id, {})\n            group_name = group_info.get("name", group_id)\n            lines.append(f"## {group_name}\\n\\n")\n\n            for plugin in grouped_plugins[group_id]:\n                # \u72b6\u6001\u53ea\u5bf9\u5e94\u65b9\u62ec\u53f7\u4e2d\u95f4\u7684\u503c\n                status = StatusMapper.get_status_symbol(\n                    plugin["enabled"], plugin["tags"]\n                )\n                line = f"- [{status}] {plugin[\'id\']}"\n\n                # \u6dfb\u52a0\u989d\u5916\u5c5e\u6027\n                if extra_attrs:\n                    attr_values = []\n                    for attr in extra_attrs:\n                        if attr in {"enabled", "id"} or attr not in plugin:\n                            continue\n                        value = plugin.get(attr, "")\n                        if isinstance(value, list):\n                            value = ",".join(value)\n                        attr_values.append(str(value))\n                    if attr_values:\n                        line += " | " + " | ".join(attr_values)\n\n                lines.append(line + "\\n")\n\n            lines.append("\\n")\n\n        # \u8f93\u51fa\u7ed3\u679c\n        content = "".join(lines)\n\n        if output_path:\n            try:\n                with open(output_path, "w", encoding="utf-8") as f:\n                    f.write(content)\n                print(f"\u63d2\u4ef6\u5217\u8868\u5df2\u5bfc\u51fa: {output_path}")\n            except Exception as e:\n                print(f"\u5bfc\u51faMarkdown\u51fa\u9519: {e}")\n        else:\n            print(content)\n\ndef main():\n    basepath = sys.argv[1] if len(sys.argv) > 1 else ".obsidian"\n    pm = PluginManager(basepath)\n\n    pm.export_md(\n        condition=lambda p: any(\n            tag in p["tags"]\n            for tag in StatusMapper.TAGS_PRIORITY[:2]\n            or (\n                p["enabled"]\n                and all(tag not in p["tags"] for tag in StatusMapper.TAGS_PRIORITY[2:])\n            )\n        ),\n        extra_attrs=[],\n    )\n\nif __name__ == "__main__":\n    main()\n\n'})})]})}function o(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(g,{...n})}):g(n)}}}]);