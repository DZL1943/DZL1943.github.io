"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[9730],{15963(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"Computer/Application/Obsidian/obsidian-quickadd","title":"QuickAdd","description":"\u6982\u8ff0","source":"@site/vault/docs/Computer/90_Application/Obsidian/obsidian-quickadd.md","sourceDirName":"Computer/90_Application/Obsidian","slug":"/Computer/Application/Obsidian/obsidian-quickadd","permalink":"/docs/Computer/Application/Obsidian/obsidian-quickadd","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Obsidian/Plugins","permalink":"/docs/tags/obsidian-plugins"}],"version":"current","lastUpdatedAt":1768490769000,"frontMatter":{"title":"QuickAdd","tags":["Obsidian/Plugins"],"aliases":["quickadd"],"url":["https://quickadd.obsidian.guide/docs/"],"date":"2024-12-04T14:32"},"sidebar":"obsidianSidebar","previous":{"title":"Obsidian Minimal","permalink":"/docs/Computer/Application/Obsidian/obsidian-minimal-theme"},"next":{"title":"Spaced Repetition","permalink":"/docs/Computer/Application/Obsidian/obsidian-spaced-repetition"}}');var a=t(74848),s=t(28453);const l={title:"QuickAdd",tags:["Obsidian/Plugins"],aliases:["quickadd"],url:["https://quickadd.obsidian.guide/docs/"],date:"2024-12-04T14:32",last_update:void 0},r=void 0,c={},o=[{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:2},{value:"Template",id:"template",level:2},{value:"Capture",id:"capture",level:2},{value:"Macro",id:"macro",level:2},{value:"Multi",id:"multi",level:2},{value:"Syntax",id:"syntax",level:2},{value:"Inline scripts",id:"inline-scripts",level:2},{value:"API",id:"api",level:2},{value:"User Scripts",id:"user-scripts",level:2},{value:"Examples",id:"examples",level:2},{value:"\u5f00\u5173\u4ee3\u7801\u7247\u6bb5",id:"\u5f00\u5173\u4ee3\u7801\u7247\u6bb5",level:3},{value:"\u8df3\u8f6c\u6807\u9898",id:"\u8df3\u8f6c\u6807\u9898",level:3},{value:"\u6b63\u5219\u66ff\u6362",id:"\u6b63\u5219\u66ff\u6362",level:3},{value:"\u9644\u4ef6\u7ba1\u7406",id:"\u9644\u4ef6\u7ba1\u7406",level:3},{value:"Tips",id:"tips",level:2},{value:"require",id:"require",level:3},{value:"\u5168\u5c40\u53d8\u91cf",id:"\u5168\u5c40\u53d8\u91cf",level:3}];function d(e){const n={a:"a",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"\u6982\u8ff0",children:"\u6982\u8ff0"}),"\n",(0,a.jsxs)(n.p,{children:["QuickAdd \u7684 \u6838\u5fc3\u6982\u5ff5\u662f Choice, \u5373\u5f53\u4f60\u901a\u8fc7\u547d\u4ee4\u6216\u5feb\u6377\u952e\u8fd0\u884c\u65f6, \u4f1a\u663e\u793a\u4e00\u4e2a\u9009\u9879\u5217\u8868, \u4f60\u53ef\u4ee5\u4ece\u4e2d\u9009\u62e9\u4f60\u8981\u8fd0\u884c\u7684\u529f\u80fd.",(0,a.jsx)(n.br,{}),"\n","\u8fd9\u4e9b Choice \u5206\u4e3a Template\u3001Capture\u3001Macro\u3001Multi \u56db\u7c7b. \u6bcf\u4e2a Choice \u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u5355\u72ec\u7684\u5feb\u6377\u952e, \u5176\u4e2d Macro \u8fd8\u80fd\u591f\u5728\u542f\u52a8\u65f6\u81ea\u52a8\u8fd0\u884c."]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Template: \u8f83\u5c11\u7528, ",(0,a.jsx)(n.strong,{children:"\u8bed\u6cd5"}),"\u7c7b\u4f3c\u81ea\u5e26\u6a21\u677f\u63d2\u4ef6, ",(0,a.jsx)(n.strong,{children:"\u517c\u5bb9 Templater"}),"? \u4f18\u70b9\u662f\u80fd\u591f\u5f88\u65b9\u4fbf\u7684\u9884\u7559\u5f85\u586b\u7a7a\u4f4d, \u521b\u5efa\u65f6\u4f1a\u63d0\u793a\u586b\u5199. \u652f\u6301 Inline Script"]}),"\n",(0,a.jsx)(n.li,{children:"Capture: \u6700\u5e38\u7528, \u4f5c\u7528\u52c9\u5f3a\u7c7b\u4f3c Templater \u7684 Insert \u6a21\u5f0f, \u4f46\u66f4\u5f3a\u5927\u6613\u7528. \u652f\u6301 Template \u8bed\u6cd5(format syntax)\u3001Inline Script"}),"\n",(0,a.jsxs)(n.li,{children:["Macro: \u4e00\u7cfb\u5217\u547d\u4ee4\u3001Choice \u7684\u6709\u5e8f\u7ec4\u5408, \u652f\u6301 User Script, \u7c7b\u4f3c Templater \u7684",(0,a.jsx)(n.code,{children:"%*"}),"\u6a21\u5f0f, \u5373\u5199 js \u4ee3\u7801."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Api"}),": \u5728\u5199 User Script \u65f6\u7528\u5230(\u4e5f\u53ef\u4ee5\u5728\u5176\u4ed6\u63d2\u4ef6\u4e2d\u8c03\u7528). \u6838\u5fc3\u5c31\u662f Prompt\u3001Suggester, \u76f8\u5f53\u4e8e\u4e00\u4e2a\u65b9\u4fbf\u83b7\u53d6\u7528\u6237\u8f93\u5165\u7684",(0,a.jsx)(n.em,{children:"\u8868\u5355"}),"."]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"\u4e0e Templater \u534f\u540c"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u4f18\u5148\u7528 tp \u7684\u6a21\u677f\u683c\u5f0f"}),"\n",(0,a.jsx)(n.li,{children:"\u907f\u514d\u5728\u6a21\u677f\u4e2d\u6df7\u6742\u65e0\u5173\u4ee3\u7801"}),"\n",(0,a.jsx)(n.li,{children:"\u5c3d\u91cf\u5c06\u4ee3\u7801\u72ec\u7acb\u6210 js, qa\u3001tp \u5747\u80fd\u901a\u7528"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"template",children:"Template"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"template path: \u5fc5\u9700"}),"\n",(0,a.jsx)(n.li,{children:"filename format"}),"\n",(0,a.jsx)(n.li,{children:"location folder"}),"\n",(0,a.jsx)(n.li,{children:"linking"}),"\n",(0,a.jsx)(n.li,{children:"behavior"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"\u7279\u70b9:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u7c7b\u4f3c\u81ea\u5e26\u6a21\u677f\u63d2\u4ef6\u7684\u8bed\u6cd5"}),"\n",(0,a.jsx)(n.li,{children:"\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u9884\u7559\u5f85\u586b\u7a7a\u4f4d, \u521b\u5efa\u65f6\u4f1a\u63d0\u793a\u586b\u5199"}),"\n",(0,a.jsx)(n.li,{children:"\u517c\u5bb9 tp"}),"\n",(0,a.jsx)(n.li,{children:"\u652f\u6301 inline script"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"capture",children:"Capture"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"location file path/format"}),"\n",(0,a.jsx)(n.li,{children:"position top/cursor/bottom"}),"\n",(0,a.jsx)(n.li,{children:"linking"}),"\n",(0,a.jsx)(n.li,{children:"content format"}),"\n",(0,a.jsx)(n.li,{children:"behavior"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"macro",children:"Macro"}),"\n",(0,a.jsxs)(n.p,{children:["A ",(0,a.jsx)(n.strong,{children:"macro"})," is a collection of commands that execute sequentially. Each macro is associated with a ",(0,a.jsx)(n.strong,{children:"macro choice"}),", which allows you to trigger the macro from the QuickAdd command palette."]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"obsidian command"}),"\n",(0,a.jsx)(n.li,{children:"editor commands"}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.strong,{children:"user scripts"})}),"\n",(0,a.jsx)(n.li,{children:"choices"}),"\n",(0,a.jsx)(n.li,{children:"wait"}),"\n",(0,a.jsx)(n.li,{children:"open file"}),"\n",(0,a.jsx)(n.li,{children:"conditional"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["When using ",(0,a.jsx)(n.code,{children:"{{VALUE:variableName}}"})," in your templates, QuickAdd decides whether to prompt you for input based on how the variable was set in your script:"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Variables That Trigger Prompts"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Unset variables: Variables that were never assigned a value"}),"\n",(0,a.jsxs)(n.li,{children:["Undefined variables: Variables explicitly set to ",(0,a.jsx)(n.code,{children:"undefined"})," in scripts"]}),"\n",(0,a.jsxs)(n.li,{children:["Null variables: Variables explicitly set to ",(0,a.jsx)(n.code,{children:"null"})," in scripts"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Variables That Don't Trigger Prompts"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Empty string variables: Variables explicitly set to ",(0,a.jsx)(n.code,{children:'""'})," in scripts"]}),"\n",(0,a.jsxs)(n.li,{children:["Variables with any other value: Including ",(0,a.jsx)(n.code,{children:'"0"'}),", ",(0,a.jsx)(n.code,{children:'"false"'}),", or any non-empty string"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"After setting variables in a script, you can use them in subsequent commands:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["In templates: ",(0,a.jsx)(n.code,{children:"{{VALUE:bookTitle}}"})]}),"\n",(0,a.jsxs)(n.li,{children:["In file names: ",(0,a.jsx)(n.code,{children:"Books/{{VALUE:bookTitle}} - Notes"})]}),"\n",(0,a.jsxs)(n.li,{children:["In captures: ",(0,a.jsx)(n.code,{children:'Read "{{VALUE:bookTitle}}" on {{VALUE:readDate}}'})]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Exporting Multiple Functions"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'module.exports = {\n    option1: async (params) => {\n        console.log("Running option 1");\n    },\n    \n    option2: async (params) => {\n        console.log("Running option 2");\n    },\n    \n    // Can also include variables\n    defaultValue: "some default",\n    \n    // Main entry point\n    start: async (params) => {\n        const { quickAddApi } = params;\n        const choice = await quickAddApi.suggester(\n            ["Run Option 1", "Run Option 2"],\n            ["option1", "option2"]\n        );\n        \n        if (choice === "option1") {\n            await module.exports.option1(params);\n        } else if (choice === "option2") {\n            await module.exports.option2(params);\n        }\n    }\n};\n'})}),"\n",(0,a.jsx)(n.p,{children:"You can skip the selection prompt by specifying the function directly:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"{{MACRO:MyMacro::option1}}"})," - Runs option1 directly"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"{{MACRO:MyMacro::start}}"})," - Runs the start function"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"\u5b8f\u53ef\u4ee5\u8bbe\u7f6e\u5728 obsidian \u542f\u52a8\u65f6\u8fd0\u884c."}),"\n",(0,a.jsx)(n.h2,{id:"multi",children:"Multi"}),"\n",(0,a.jsx)(n.p,{children:"\u76f8\u5f53\u4e8e\u4e8c\u7ea7\u83dc\u5355, \u7528\u5904\u4e0d\u5927"}),"\n",(0,a.jsx)(n.p,{children:"\u62d6\u52a8\u4ee5\u7ec4\u5408"}),"\n",(0,a.jsx)(n.h2,{id:"syntax",children:"Syntax"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.a,{href:"https://quickadd.obsidian.guide/docs/FormatSyntax",children:"https://quickadd.obsidian.guide/docs/FormatSyntax"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"{{DATE:<DATEFORMAT>}}"})," %% \u548c\u81ea\u5e26\u8bed\u6cd5\u4e00\u6837 %%"]}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"{{VDATE:<variable-name>, <date-format>|<default>}}"})}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"{{VALUE:<options>|custom}}"}),": Use comma separation to get a suggester rather than a prompt."]}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"{{LINKCURRENT}}"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"{{FILENAMECURRENT}}"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"{{MACRO:<MACRONAME>}}"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"{{TEMPLATE:<TEMPLATEPATH>}}"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"{{GLOBAL_VAR:<name>}}"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"{{MVALUE}}"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"{{FIELD:<FIELDNAME>}}"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"{{selected}}"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"{{CLIPBOARD}}"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"{{RANDOM:<length>}}"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"{{TITLE}}"})}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"inline-scripts",children:"Inline scripts"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:"quickadd",children:'const input = await this.quickAddApi.inputPrompt("\u270d");\nreturn `Input given: ${input}`;\n'})}),"\n",(0,a.jsxs)(n.p,{children:["\u4e5f\u53ef\u4ee5\u7528 ",(0,a.jsx)(n.code,{children:"{{MACRO:}}"})," \u7684\u5f62\u5f0f\u83b7\u5f97\u5176 return \u503c."]}),"\n",(0,a.jsx)(n.h2,{id:"api",children:"API"}),"\n",(0,a.jsx)(n.p,{children:"Accessing the API"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"From QuickAdd Scripts (Macros/User Scripts)"}),"\n",(0,a.jsx)(n.li,{children:"From Other Plugins/Scripts"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"User Input Methods"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["requestInputs","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"id"})," (string, required)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"label"})," (string)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"type"}),' ("text" | "textarea" | "dropdown" | "date" | "field-suggest" | "suggester")']}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"placeholder"})," (string)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"defaultValue"})," (string)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"options"})," (string[] for dropdown and suggester)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"dateFormat"})," (string for date)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"description"})," (string)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"suggesterConfig"})," (object for suggester: ",(0,a.jsx)(n.code,{children:"{ allowCustomInput?: boolean, caseSensitive?: boolean, multiSelect?: boolean }"}),")"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.li,{children:"inputPrompt"}),"\n",(0,a.jsx)(n.li,{children:"wideInputPrompt"}),"\n",(0,a.jsx)(n.li,{children:"yesNoPrompt"}),"\n",(0,a.jsx)(n.li,{children:"infoDialog"}),"\n",(0,a.jsx)(n.li,{children:"suggester"}),"\n",(0,a.jsx)(n.li,{children:"checkboxPrompt"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'module.exports = async (params) => {\n    const { quickAddApi } = params;\n    \n    // Text input\n    const text = await quickAddApi.inputPrompt("Enter text:");\n    \n    // Wide text input (multi-line)\n    const longText = await quickAddApi.wideInputPrompt("Enter description:");\n    \n    // Yes/No confirmation\n    const confirmed = await quickAddApi.yesNoPrompt("Are you sure?");\n    \n    // Suggester (dropdown selection)\n    const choice = await quickAddApi.suggester(\n        ["Option 1", "Option 2", "Option 3"],\n        ["value1", "value2", "value3"]\n    );\n    \n    // Checkbox selection\n    const selected = await quickAddApi.checkboxPrompt(\n        ["Item 1", "Item 2", "Item 3"],\n        ["Item 1"]  // Pre-selected items\n    );\n};\n'})}),"\n",(0,a.jsx)(n.p,{children:"Format"}),"\n",(0,a.jsx)(n.p,{children:"Choice Execution"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"executeChoice"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Utility Module"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"getClipboard"}),"\n",(0,a.jsx)(n.li,{children:"setClipboard"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Date Module"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"now"}),"\n",(0,a.jsx)(n.li,{children:"tomorrow"}),"\n",(0,a.jsx)(n.li,{children:"yesterday"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"AI Module"}),"\n",(0,a.jsx)(n.p,{children:"Field Suggestions Module"}),"\n",(0,a.jsx)(n.h2,{id:"user-scripts",children:"User Scripts"}),"\n",(0,a.jsx)(n.p,{children:"User scripts are JavaScript files that extend macro functionality. They have access to:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"The Obsidian app object"}),"\n",(0,a.jsx)(n.li,{children:"The QuickAdd API"}),"\n",(0,a.jsx)(n.li,{children:"A variables object for passing data between commands"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Every user script must export a module with at least an entry point function.\nOr with the object syntax:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'module.exports = {\n    entry: start,\n    settings: {\n        name: "Script Name",\n        author: "Your Name",\n        options: {\n            // Define configurable options here\n        }\n    }\n};\n\nasync function start(params, settings) {\n    const { app, quickAddApi, variables, obsidian } = params;\n    // Your code here\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"params"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"const {\n    app: _app = app,                  // Obsidian app instance - see https://docs.obsidian.md/Reference/TypeScript+API/App\n    obsidian,         // Obsidian module with all classes and utilities\n    quickAddApi: app.plugins.plugins.quickadd.api,   // QuickAdd API methods (documented below)\n    variables = {},              // Variables object for sharing data between scripts and templates\n    abort: (message) => never   // Abort macro execution with optional message\n} = params || {};\n"})}),"\n",(0,a.jsx)(n.p,{children:"settings - option type"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"text"}),"\n",(0,a.jsx)(n.li,{children:"toggle"}),"\n",(0,a.jsx)(n.li,{children:"dropdown"}),"\n",(0,a.jsx)(n.li,{children:"format"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Multiple Entry Points"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'module.exports = {\n    "Create Note": createNote,\n    "Update Note": updateNote,\n    "Delete Note": deleteNote\n};\n\nasync function createNote(params) {\n    // Implementation\n}\n\nasync function updateNote(params) {\n    // Implementation\n}\n\nasync function deleteNote(params) {\n    // Implementation\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Recipes"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:'title:"working-with-files" fold',children:'async function start(params, settings) {\n    const { app, obsidian } = params;\n    \n    // Get all markdown files\n    const files = app.vault.getMarkdownFiles();\n    \n    // Get a specific file\n    const file = app.vault.getAbstractFileByPath("path/to/file.md");\n    if (file instanceof obsidian.TFile) {\n        // Read file content\n        const content = await app.vault.read(file);\n        \n        // Get file metadata\n        const metadata = app.metadataCache.getFileCache(file);\n        const frontmatter = metadata?.frontmatter;\n        const links = metadata?.links || [];\n        const tags = metadata?.tags || [];\n        \n        // Process content\n        const modified = content.replace(/old/g, "new");\n        \n        // Save changes\n        await app.vault.modify(file, modified);\n    }\n    \n    // Create new file\n    const newFile = await app.vault.create(\n        "folder/subfolder/new-note.md", \n        "# Title\\n\\nContent here"\n    );\n    \n    // Rename file\n    await app.fileManager.renameFile(\n        newFile, \n        "folder/subfolder/renamed-note.md"\n    );\n    \n    // Delete file\n    await app.vault.delete(newFile);\n    \n    // Copy file\n    await app.vault.copy(\n        file, \n        "path/to/copy.md"\n    );\n    \n    // Get folder\n    const folder = app.vault.getAbstractFileByPath("folder/subfolder");\n    if (folder instanceof obsidian.TFolder) {\n        // List folder contents\n        const children = folder.children;\n        \n        // Create folder if it doesn\'t exist\n        const path = "new/folder/structure";\n        if (!app.vault.getAbstractFileByPath(path)) {\n            await app.vault.createFolder(path);\n        }\n    }\n}\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:'title:"working-with-the-active-file" fold',children:'async function start(params, settings) {\n    const { app, obsidian } = params;\n    \n    // Get active file\n    const activeFile = app.workspace.getActiveFile();\n    if (!activeFile) {\n        new obsidian.Notice("No active file");\n        return;\n    }\n    \n    // Get active editor\n    const activeView = app.workspace.getActiveViewOfType(obsidian.MarkdownView);\n    if (activeView) {\n        const editor = activeView.editor;\n        \n        // Get selected text\n        const selection = editor.getSelection();\n        \n        // Get current line\n        const cursor = editor.getCursor();\n        const line = editor.getLine(cursor.line);\n        \n        // Replace selection\n        editor.replaceSelection("New text");\n        \n        // Insert at cursor\n        editor.replaceRange(\n            "Inserted text", \n            cursor\n        );\n        \n        // Get entire document\n        const fullText = editor.getValue();\n        \n        // Replace entire document\n        editor.setValue("Completely new content");\n    }\n}\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:'title:"working-with-metadata-and-frontmatter" fold',children:'async function start(params, settings) {\n    const { app, obsidian } = params;\n    \n    const file = app.workspace.getActiveFile();\n    if (!file) return;\n    \n    // Get frontmatter\n    const cache = app.metadataCache.getFileCache(file);\n    const frontmatter = cache?.frontmatter || {};\n    \n    // Update frontmatter\n    await app.fileManager.processFrontMatter(file, (fm) => {\n        fm.tags = fm.tags || [];\n        fm.tags.push("processed");\n        fm.date = new Date().toISOString();\n        fm.status = "completed";\n        delete fm.oldField;  // Remove a field\n    });\n    \n    // Get all files with specific frontmatter\n    const filesWithTag = app.vault.getMarkdownFiles().filter(f => {\n        const meta = app.metadataCache.getFileCache(f);\n        return meta?.frontmatter?.tags?.includes("important");\n    });\n    \n    // Get backlinks\n    const backlinks = app.metadataCache.getBacklinksForFile(file);\n    \n    // Get outgoing links\n    const links = cache?.links || [];\n    const embeds = cache?.embeds || [];\n}\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:'title:"opening-and-navigating-files" fold',children:'async function start(params, settings) {\n    const { app, obsidian } = params;\n    \n    // Open file in active pane\n    const file = app.vault.getAbstractFileByPath("path/to/note.md");\n    if (file instanceof obsidian.TFile) {\n        await app.workspace.getLeaf().openFile(file);\n    }\n    \n    // Open in new pane\n    await app.workspace.getLeaf(\'split\').openFile(file);\n    \n    // Open in new tab\n    await app.workspace.getLeaf(\'tab\').openFile(file);\n    \n    // Open in new window\n    await app.workspace.getLeaf(\'window\').openFile(file);\n    \n    // Navigate to specific heading\n    await app.workspace.openLinkText(\n        "note#heading", \n        "",  // source path\n        true  // new leaf\n    );\n    \n    // Create and open a daily note\n    const { createDailyNote } = app.plugins.plugins["daily-notes"].instance;\n    const dailyNote = await createDailyNote(moment());\n    await app.workspace.getLeaf().openFile(dailyNote);\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,a.jsx)(n.h3,{id:"\u5f00\u5173\u4ee3\u7801\u7247\u6bb5",children:"\u5f00\u5173\u4ee3\u7801\u7247\u6bb5"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"module.exports = async function toggleSnippets(params) {\n    const { quickAddApi = app.plugins.plugins.quickadd.api } = params || {};\n\n    const snippets = app.customCss.snippets;\n    const enabledSnippets = app.customCss.enabledSnippets;\n\n    const selected = await quickAddApi.checkboxPrompt(\n        snippets,\n        enabledSnippets\n    );\n\n    for (const snippet of snippets) {\n        app.customCss.setCssEnabledStatus(snippet, selected.includes(snippet));\n    }\n    app.customCss.requestLoadSnippets();\n};\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u8df3\u8f6c\u6807\u9898",children:"\u8df3\u8f6c\u6807\u9898"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"async function generateHeadings(params){\n    const { quickAddApi = app.plugins.plugins.quickadd.api, variables = {} } = params || {};\n    const { headings } = app.metadataCache.getFileCache(app.workspace.getActiveFile());\n    if (!headings) return;\n\n    const startHeadingLevel = 1;\n    variables.result = headings.map(h => `${' '.repeat((h.level - startHeadingLevel) * 4)}- ${h.heading}`).join('\\n');\n    await quickAddApi.utility.setClipboard(variables.result);\n    return variables.result;\n}\n\nasync function showAndGotoHeadings(params) {\n    const { quickAddApi = app.plugins.plugins.quickadd.api } = params || {};\n    const { headings } = app.metadataCache.getFileCache(app.workspace.getActiveFile());\n    if (!headings) return;\n\n    const heading = await quickAddApi.suggester(\n        headings.map(h=>`H${h.level}: ${h.heading}`),    // default render\n        headings,\n        'choose a heading to goto',\n        false,\n        {renderItem: (h, el) => {\n            const row = el.createEl('div');\n            const marker = row.createEl('span', {text: 'H'});\n            marker.setAttr('style', `font-weight:bold;color:var(--h${h.level}-color)`);\n            const level = row.createEl('sub', {text: `${h.level}`});\n            level.setAttr('style', `color:gray;`);\n            row.createEl('span', {text: `  ${h.heading}`});\n        }}\n    );\n    \n    app.workspace.activeLeaf?.view?.currentMode.applyScroll(heading.position.start.line);\n}\n\nmodule.exports = {\n    entry: showAndGotoHeadings,\n    generateHeadings,\n};\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u6b63\u5219\u66ff\u6362",children:"\u6b63\u5219\u66ff\u6362"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:"fold",children:"let Notice;\n\nfunction applyRule(rule, text) {\n    if (!text || !rule) return text;\n    \n    const { pattern, replacement, useRegex } = Array.isArray(rule) \n        ? { pattern: rule[0], replacement: rule[1], useRegex: rule[2] }\n        : rule || {};\n\n    if (!pattern) return text;\n\n    try {\n        const isRegex = /^(true|yes|y|1|\u662f)$/i.test(String(useRegex || \"\").trim());\n        const newText = isRegex\n            ? text.replace(new RegExp(pattern, \"gm\"), replacement || \"\")\n            : text.replaceAll(pattern, replacement || \"\");\n        console.debug(`Replace \"${pattern}\" success.`);\n        return newText;\n    } catch(error) {\n        console.error(`Replace \"${pattern}\" failed:`, error);\n        return text;\n    }\n}\n\nasync function replaceInFile(rules, file) {\n    let content = await app.vault.read(file);\n    \n    for (const rule of rules) {\n        if (!content) break;\n        content = applyRule(rule, content);\n    }\n    await app.vault.modify(file, content);\n}\n\nasync function globalReplace(rules, filter) {\n    const files = app.vault.getMarkdownFiles();\n    for (const file of files) {\n        if(!filter || filter(file))\n            await replaceInFile(rules, file);\n    }\n    new Notice(`Finished.`, 3000);\n}\n\nfunction replaceByEditor(rules, editor) {\n    if (!editor) return;\n    const selection = editor.getSelection();\n    let text = selection || editor.getValue();\n    \n    for (const rule of rules) {\n        if (!text) break;\n        text = applyRule(rule, text);\n    }\n    selection ? editor.replaceSelection(text) : editor.setValue(text);\n    new Notice(`Finished.`, 3000);\n}\n\nasync function start(params, settings) {\n    const { obsidian, quickAddApi = app.plugins.plugins.quickadd.api } = params || {};\n    ({ Notice } = obsidian);\n\n    let ruleset;\n    try {\n        ruleset = {scope: settings.scope, rules: JSON.parse(settings.rules || \"[]\")}\n    } catch (error) {}\n\n    if (!ruleset?.rules?.length) {\n        const inputs = await quickAddApi?.requestInputs([\n            { id: 'pattern', label: \"\u67e5\u627e\", type: \"text\" },\n            { id: 'replacement', label: \"\u66ff\u6362\", type: \"text\" },\n            { id: 'useRegex', label: \"\u6b63\u5219\", type: \"dropdown\", options: ['yes', 'no'], defaultValue: 'no' },\n            { id: 'scope', label: \"\u8303\u56f4\", type: \"dropdown\", options: ['selection', 'file', 'folder', 'vault'], defaultValue: 'file' },\n        ]);\n        ruleset = {scope: inputs.scope, rules: [inputs]}\n    }\n\n    const {scope, rules} = ruleset;\n    switch (scope) {\n        case 'selection':\n        case 'file':\n            replaceByEditor(rules, app.workspace.activeEditor?.editor);\n            break;\n        case 'folder':\n            const currentFolder = app.workspace.getActiveFile().parent.path;\n            await globalReplace(rules, (f) => f.parent.path === currentFolder);\n            break;\n        case 'vault':\n            await globalReplace(rules);\n            break;\n        default:\n            break;\n    }\n}\n\nmodule.exports = {\n    entry: start,\n    settings: {\n        name: '',\n        author: '',\n        options: {\n            rules: {\n                type: \"textarea\",\n                defaultValue: \"[]\",\n                placeholder: '[[\"pattern\", \"replacement\", \"useRegex\"]]',\n            },\n            scope: {\n                type: \"dropdown\",\n                defaultValue: \"file\",\n                options: ['selection', 'file', 'folder', 'vault']\n            }\n        }\n    }\n}\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u4f8b\u5b50:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\u79fb\u9664\u5916\u90e8\u94fe\u63a5 ",(0,a.jsx)(n.code,{children:"(?<!!)\\[([^\\]]+)\\]\\([^)]+\\)"})," -> ",(0,a.jsx)(n.code,{children:"$1"})]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"\u9644\u4ef6\u7ba1\u7406",children:"\u9644\u4ef6\u7ba1\u7406"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:"fold",children:"let TFile;\n\nconst imageExtensions = ['avif', 'bmp', 'gif', 'jpeg', 'jpg', 'png', 'svg', 'webp'];\n\nfunction getByIndex(arr, pos) {\n    return arr?.[Math.max(0,Math.min(pos < 0 ? arr.length + pos : pos, arr.length - 1))];\n}\n\nasync function poll(func, { interval = 100, timeout = 3000, attempts } = {}) {\n    const endTime = Date.now() + timeout;\n    for (let count = 0; Date.now() < endTime && (!attempts || count < attempts); count++) {\n        const result = await func();\n        if (result) return result;\n        await new Promise(r => setTimeout(r, interval));\n    }\n}\n\n// const tagPartsCache = new WeakMap();\n\nfunction getTagParts(tags) {\n    if (!tags) return new Set();\n    \n    // if (tagPartsCache.has(tags)) {\n    //     return tagPartsCache.get(tags);\n    // }\n    \n    const parts = new Set();\n    \n    for (const tag of tags) {\n        const segments = tag.split('/');\n        for (let i = 0; i < segments.length; i++) {\n            for (let j = i; j < segments.length; j++) {\n                const subPath = segments.slice(i, j + 1).join('/');\n                parts.add(subPath);\n            }\n        }\n    }\n    \n    // tagPartsCache.set(tags, parts);\n    return parts;\n}\n\nfunction hasTag(tags, pattern) {\n    const regex = new RegExp(`(^|/)${pattern.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}(/|$)`);\n    return tags?.some(tag => regex.test(tag)) ?? false;\n}\n\nasync function renameAttachment(file) {\n    if (!imageExtensions.includes(file.extension.toLowerCase())) return;\n    \n    const newName = `${file.stat.ctime}-${file.stat.size}.${file.extension}`;\n    if (file.name === newName) return;\n    \n    await app.fileManager.renameFile(file, `${file.parent.path}/${newName}`);\n}\n\nasync function renameAttachmentsInFolder(folder) {\n    const files = Array.from(folder.children).filter(e => e instanceof TFile);\n    \n    for (const file of files) {\n        try {\n            await renameAttachment(file);\n        } catch (error) {\n            console.error(`Failed to rename ${file.path}`, error);\n        }\n    }\n}\n\nasync function renameAttachmentsInFile(file) {\n    if (file.extension !== 'md') return;\n    \n    const cache = app.metadataCache.getFileCache(file);\n    const links = [\n        ...(cache?.embeds?.map(e => e.link) || []),\n        ...(cache?.frontmatterLinks?.map(e => e.link) || [])\n    ].filter(link => link);\n    const processed = new Set();\n    \n    for (const link of links) {\n        try {\n            const attachment = app.metadataCache.getFirstLinkpathDest(link, file.path);\n            if (attachment && !processed.has(attachment.path)) {\n                processed.add(attachment.path);\n                await renameAttachment(attachment);\n            }\n        } catch (error) {\n            console.error(`Failed to rename ${link}`, error);\n        }\n    }\n}\n\nasync function downloadAttachments(file) {\n    if (file.extension !== 'md') return;\n    await app.workspace.getLeaf().openFile(file);\n    await app.commands.executeCommandById('editor:download-attachments');\n    (await poll(() => document.querySelector('.mod-cta')))?.click();\n    \n    if(!await poll(() => {\n        const cache = app.metadataCache.getFileCache(file);\n        return !!(cache?.embeds?.length || cache?.frontmatterLinks?.length);\n    })) return;\n    \n    const cache = app.metadataCache.getFileCache(file);\n    const fm = cache.frontmatter;\n    if (!fm.image && cache.embeds?.length) {\n        await app.fileManager.processFrontMatter(file, (fm) => {\n            fm.image = `[[${getByIndex(cache.embeds, -1).link}]]`;\n        });\n    }\n}\n\nasync function registerEvent(params) {\n    app.plugins.plugins.quickadd.registerEvent(app.vault.on('create', async (file) => {\n        if (file.extension === 'md') {\n            if (!await poll(() => {\n                const tags = app.metadataCache.getFileCache(file)?.frontmatter?.tags;\n                if (!tags) return false;\n                \n                const tagParts = getTagParts(tags);\n                return tagParts.has('clippings');\n            })) return;\n            await downloadAttachments(file);\n            await renameAttachmentsInFile(file);\n        } \n        // else {\n            //     renameAttachment(file);\n        // }\n    }));\n    console.log('registered');\n}\n\nasync function cleanUnusedAttachments(params) {\n    const {quickAddApi = app.plugins.plugins.quickadd.api} = params || {};\n    const attachments = app.vault.getFiles().filter(f => imageExtensions.includes(f.extension.toLowerCase()));\n    \n    const unused = Object.fromEntries(\n        attachments\n            .filter((a) => !app.metadataCache.getBacklinksForFile(a)?.data?.size)\n            .map((a) => [a.path, a])\n    );\n\n    const selected = await quickAddApi.checkboxPrompt(Object.keys(unused));\n    for (path of selected) {\n        try {\n            await app.vault.delete(unused[path]);\n            console.log(`Delete ${path} success.`);\n        } catch(error) {\n            console.error(`Delete ${path} failed: ${error}`);\n        }\n    }\n}\n\nmodule.exports = {\n    registerEvent,\n    downloadAttachments: async (params) => {\n        await downloadAttachments(app.workspace.getActiveFile());\n    },\n    downloadAndRenameAttachments: async (params) => {\n        const file = app.workspace.getActiveFile();\n        await downloadAttachments(file);\n        await renameAttachmentsInFile(file);\n    },\n    renameAttachmentsInCurrentFile: async (params) => {\n        await renameAttachmentsInFile(app.workspace.getActiveFile());\n    },\n    renameAttachmentsInFolder: async (params) => {\n        const { app, obsidian, quickAddApi } = params || {};\n        ({TFile} = obsidian);\n        const folders = app.vault.getAllFolders(true);\n        const folder = await quickAddApi.suggester(\n            folders.map(i=>i.path),\n            folders\n        );\n        await renameAttachmentsInFolder(folder);\n    },\n    cleanUnusedAttachments,\n};\n"})}),"\n",(0,a.jsx)(n.h2,{id:"tips",children:"Tips"}),"\n",(0,a.jsx)(n.h3,{id:"require",children:"require"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"const mod = require(app.vault.adapter.basePath+'/path/xxx.js');\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u5168\u5c40\u53d8\u91cf",children:"\u5168\u5c40\u53d8\u91cf"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"let obsidian, Notice;\n\nfunction test(){\n    new Notice(`${obsidian.apiVersion}`, 1000);\n}\n\nasync function start(params, settings) {\n    const {\n        app: _app = app,\n        obsidian: _ob,\n        quickAddApi = app.plugins.plugins.quickadd.api,\n        variables = {},\n    } = params || {};\n    obsidian = _ob;\n    ({Notice} = obsidian);\n    test();\n    variables.result = app.workspace.getActiveFile().parent.path;\n    return variables.result;\n}\n\nmodule.exports = {\n    entry: start,\n    // settings: {name: '', author: '', options: {}}\n}\n"})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},28453(e,n,t){t.d(n,{R:()=>l,x:()=>r});var i=t(96540);const a={},s=i.createContext(a);function l(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);